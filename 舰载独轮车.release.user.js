// ==UserScript==
// @version       4.0.9
// @icon          https://www.youtube.com/favicon.ico
// @author        necros & dislido
// @match         *://www.youtube.com/*
// @match         *://accounts.google.com/*
// @match         *://twitter.com/*
// @grant         unsafeWindow
// @grant         GM_xmlhttpRequest
// @grant         GM_log
// @grant         window.close
// @grant         GM_notification
// @grant         GM_setValue
// @grant         GM_getValue
// @connect       localhost
// @namespace     1551@andy.com
// @description   cv-6用舰载机：59改-谢斌
// @name          舰载型Youtube泥头车
// ==/UserScript==
(()=>{var __webpack_modules__={182:(e,t,n)=>{n.d(t,{vc:()=>o,Dc:()=>l,$:()=>c,ME:()=>a});const o={o:"舰载型Youtube泥头车"===GM_info.script.name,configName:"舰载型Youtube泥头车"===GM_info.script.name?"carrierBasedDuluncheCfg":"duluncheCfg",accountNames:["巫女萌え","松山チハル","桐生会直系龍心会","水没","白滝","空下峠","錦山彰"],autoDownVote:!1,fireImmediately:!0,minDownVoteMin:300,maxDownVoteMin:360,minChangeChannel:20,maxChangeChannel:30,autoAttack:!1,cycleCheck:!0,gatlingAutoStop:!1,autoSCCheck:!1,channelsAll:[],channelsIndexCurr:0,channelsIndexStart:0,tokenLenMin:1,tokenLenMax:5,tokenDelayTime:1e3,tokenRefine:!0,tokenPruning:!0,url:"",autoSetupURL:!0,changeChannelCount:0,changeChannelTimerstamp:0,control:!0,controlPort:5e3,fireMode:0,ammoPiecingTimes:10,textAmmoPiecing:"",splitMode:2,minCycleSec:6,maxCycleSec:12,randomDanmaku:!1,text:"",maxDanmakuLength:200,minDanmakuLength:20,startTime:"2020-10-24 00:07:00",stopTime:"2020-10-24 00:07:00",splitChar:"，；：。！？…,.!?,",remoteDanmakuBase:"",noValidate:!1,modList:[],extension:"",lowConsume:!0,lowConsumeChat:!0,lowConsumeOthers:!0,autoStop:!0,infoUrl:"",startWaitingTime:100,fullAutomation:!1,lastLiveUrl:"",recallMsg:!1,ammoRefine_Disturb:!0,ammoRefine_ToLower:!0,ammoRefine_Cloud:!1,ammoRefine_Local:!0,ammoRefine_SplitWord:!1,ammoRefine_BanedWordMode:0,ammoToLatin:!1,ammoRefineStategy:"https://raw.githubusercontent.com/aserwarsdfd/logs/main/carrier-based.json",ammoRefine_prefix:!1,ammoRefine_suffix:!1,nTags:3,twitter:{tags:{primary:{桐生ココ:!0,ココここ:!0,みかじ絵:!0},secondary:{たつのこ:!0,指示クラ:!0}},bibles:{很难不支持:{content:"很 难 不 支 持",format:!1}}}},l=o.o?{suspension:"#9999CC",backgroundToast:"#CCCCFF",backgroundCmd:"#FFCCCC",titlebar:"#FF9999",border:"#FFCCCC",btn:"#996699",btnBorder:"#CCCCFF",btnColor:"#FFFFFF",closeBtnColor:"#FFFFFF",textareaBackground:"#ffe5f2",textareaColor:"#4C3333",fontColor:"#4C3333",announcementHeader:"#5e4263",helpIconBackground:"#FFFFFF",helpIconColor:"#000000",collapseBackground1:"#ead6ea",collapseBackground2:"#CCCCFF",collapseBorder:"#cc99b3"}:{suspension:"#1A59B7",backgroundToast:"lightgrey",backgroundCmd:"lightgrey",titlebar:"#fb5",border:"#ff921a",btn:"#f70",btnBorder:"gray",btnColor:"#FFFFFF",closeBtnColor:"#FFFFFF",textareaBackground:"#white",textareaColor:"#000000",fontColor:"#000000",announcementHeader:"#5e4263",helpIconBackground:"#FFFFFF",helpIconColor:"#000000",collapseBackground1:"#ff921a",collapseBackground2:"#FFE08B",collapseBorder:"#703b17"},c=(e,t,n=o.configName)=>{o[e]=t,localStorage.setItem(n,JSON.stringify(o))},a=(e=o.configName)=>{o.configName="舰载型Youtube泥头车"===GM_info.script.name?"carrierBasedDuluncheCfg":"duluncheCfg";try{const t=JSON.parse(localStorage.getItem(e));Object.assign(o,t)}catch(e){}o.o="舰载型Youtube泥头车"===GM_info.script.name,o.configName="舰载型Youtube泥头车"===GM_info.script.name?"carrierBasedDuluncheCfg":"duluncheCfg",o.o||(o.control=!1),o.modList.forEach((t=>{void 0===t.activate&&(t.activate=!0,localStorage.setItem(e,JSON.stringify(o)))}))}},368:(e,t,n)=>{n.d(t,{K:()=>r,L:()=>d});var o=n(555),l=n(182),c=n(274),a=n(750),i=n(659);const r={inited:!1,email:null,currChannel:null,currChannelID:"",nextChannel:null,channels:{},channelState:"?",addAccountButton:null,get:(e=!0)=>{if(r.inited){const t={};return t.email=r.email,t.banned=r.channelState,"?"==t.banned&&(t.banned="U"),t.currChannel=r.currChannel,t.currChannelID=r.currChannelID,t.channels=Object.keys(r.channels),t.timestamp=(new Date).getTime(),t.url=window.location.href,t.newConnection=e,t}return!1}};let s;const d=(e=!0,t=!1,n=(()=>{}))=>{const{control:m,autoDownVote:u,url:p}=l.vc;if(!m&&!u)return;if("https://www.youtube.com/"===window.location.href&&p.match(/.*:\/\/www\.youtube\.com\/watch.*/)&&l.vc.changeChannelCount>0)return l.vc.changeChannelCount=0,localStorage.setItem(l.vc.configName,JSON.stringify(l.vc)),void(window.location.href=p);if(!(window.location.href.match(/.*:\/\/www\.youtube\.com\/watch.*/)||window.location.href.match(/.*:\/\/www\.youtube\.com\/?$/)||window.location.href.match(/.*:\/\/www\.youtube\.com\/\?/)))return;if(!m&&!(0,o.jr)(window.location.href,p))return void(0,c.FN)(`目标直播间地址是${p}, 当前直播间地址是${window.location.href},不一致。不进行点踩操作`);let h=!1,g=document.getElementsByTagName("ytd-account-item-renderer");if(g.length>0){h=!0,g=Array.prototype.slice.call(g),t&&(console.log("setup curr account"),l.vc.channelsAll=[],r.channels={});for(let e=0;e<g.length;e++){let n,o=g[e],c=o.children[0].children[1].children[0].innerText,a=g[0].parentNode.parentNode.parentNode.parentNode.children[0].children[0].children[1].children[1].innerText.replace(/[\r\n]/g,"");n=o.parentNode.children.length==g.length?c:a.substr(0,a.indexOf("@")+1)+c,n in r.channels||(r.channels[n]=o,t&&l.vc.channelsAll.push(n)),r.inited||o.children[0].children[2].hidden||(r.inited=!0,r.currChannel=n,r.email=a,r.addAccountButton=o.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.children[1].children[0].children[1].children[0].children[0])}console.log(r.currChannel),console.log(r.email),console.log(r.channels),console.log(l.vc.channelsAll);let s=(0,c.h)("div",{id:"account_email",style:`\n            background: ${l.Dc.suspension};\n            color:${l.Dc.btnColor};\n            z-index: 800;\n            position: fixed;\n            padding: 5px;\n            text-align:center;\n            border-radius: 5px;\n            right: 10px;\n            top: 24%;\n          `},r.email);if(document.body.appendChild(s),t&&(l.vc.channelsIndexStart=l.vc.channelsAll.findIndex((e=>e===r.currChannel)),l.vc.channelsIndexCurr=l.vc.channelsIndexStart),console.log(`autoDownVote: ${u}`),u&&l.vc.channelsAll.length>0){let e=l.vc.channelsAll[(l.vc.channelsIndexCurr+1)%l.vc.channelsAll.length];console.log(`nextkey: ${e}`),r.nextChannel=r.channels[e],console.log(r.nextChannel)}m&&(0,a.N)(),u&&e&&((0,o.jr)(window.location.href,p)?(0,i.w7)():(0,c.FN)(`目标直播间地址是${p}, 当前直播间地址是${window.location.href},不一致。不进行点踩操作`)),n();try{document.getElementsByTagName("iron-dropdown")[0].style.display="none"}catch(e){}}else{const e=document.getElementsByClassName("yt-simple-endpoint style-scope ytd-compact-link-renderer")[3];if(null!=e){const t=document.getElementsByClassName("yt-simple-endpoint style-scope ytd-compact-link-renderer")[0].href.split("/");r.currChannelID=t[t.length-1],e.click()}else{const e=document.getElementById("avatar-btn");null!=e&&(0==document.getElementsByTagName("iron-dropdown").length||document.getElementsByTagName("iron-dropdown")[0].getAttribute("aria-hidden"))&&e.click()}}h||(s=setTimeout((()=>{d(e,t,n)}),2e3))};s=setTimeout(d,2e3)},750:(e,t,n)=>{n.d(t,{N:()=>h,S:()=>p});var o=n(803),l=n(555),c=n(182),a=n(368),i=n(996),r=n(144),s=n(274),d=n(659);const m=e=>{o.x.chatTxtInput.textContent=(0,r.e)(e.text,e.ammoRefine_Cloud,e.ammoRefine_Local,e.ammoRefine_Disturb,e.ammoRefine_ToLower,0),o.x.chatTxtInput.dispatchEvent(new InputEvent("input")),o.x.sendBtn.click()};var u=!1;const p=e=>{switch(console.log("handleServerCommand: "),console.log(e),e.command){case"stop":i.Y.emit("dlc.stop");break;case"run":if(!(0,l.jr)(window.location.href,(0,l.$t)(e.url.split("&")[0])))return void(window.location.href=(0,l.$t)(e.url.split("&")[0]));c.vc.splitMode=2,c.vc.fireMode=e.useAP?1:0,c.vc.text=e.ammo.join("\n"),c.vc.textAmmoPiecing=e.apAmmo.join("\n"),c.vc.randomDanmaku=e.randomDanmaku,c.vc.minCycleSec=e.minCycleSec,c.vc.maxCycleSec=e.maxCycleSec,c.vc.ammoRefine_Cloud=e.ammoRefine_Cloud,c.vc.ammoRefine_Local=e.ammoRefine_Local,c.vc.ammoRefine_Disturb=e.ammoRefine_Disturb,c.vc.ammoRefine_ToLower=e.ammoRefine_ToLower;try{e.recall&&(c.vc.recallMsg=!0)}catch(e){c.vc.recallMsg=!1}i.Y.emit("dlc.run");break;case"jump":(0,l.jr)(window.location.href,(0,l.$t)(e.url.split("&")[0]))||(window.location.href=(0,l.$t)(e.url.split("&")[0]));break;case"send":if(!u){let t=e.timestamp-(new Date).getTime();setTimeout((()=>m(e)),t),t<=0?m(e):(setTimeout((()=>{m(e),u=!1}),t),u=!0)}break;case"downvote":(0,l.Ux)();break;case"swap":try{if(c.vc.changeChannelCount=1,c.vc.url=window.location.href,localStorage.setItem(c.vc.configName,JSON.stringify(c.vc)),unsafeWindow.waitForDownvote){if("false"===document.getElementsByClassName("style-scope ytd-menu-renderer force-icon-button")[1].getElementsByTagName("button")[0].getAttribute("aria-pressed")&&0==o.x.dlcDownvoteEndTime){let e=(0,l.Iy)(1e3*c.vc.minDownVoteMin,1e3*Math.max(c.vc.minDownVoteMin,c.vc.maxDownVoteMin));(0,s.FN)(`舰载机挂踩插件运行中 - 过${e/1e3}s点踩。为了保证挂踩时间，涉及到切换频道的操作均会被推迟。`),d.RB=setTimeout((()=>{(0,l.Ux)(!1)}),e),o.x.dlcDownvoteEndTime=(new Date).getTime()+e+1e3*c.vc.minChangeChannel}let t=o.x.dlcDownvoteEndTime-(new Date).getTime();t>0?((0,s.FN)(`现在还没挂够点踩时间，${t/1e3}s后换频道。`),setTimeout((()=>{a.K.channels[e.channel_name].click()}),t)):a.K.channels[e.channel_name].click()}else a.K.channels[e.channel_name].click()}catch(t){console.log("Fail to change channel"),console.log(e)}break;case"change":null!=a.K.addAccountButton&&setTimeout((()=>{window.open(a.K.addAccountButton.href,"_self").focus()}),1e3);break;case"createChannel":i.Y.emit("dlc.createChannel",e.accountName);break;default:console.log("invalid command: "+e)}},h=()=>{0==o.x.CVServer&&(o.x.CVServer=new WebSocket(`ws://localhost:${c.vc.controlPort}/`)),o.x.CVServer&&(o.x.CVServer.onopen=()=>{let e=a.K.get(!0);e&&o.x.CVServer.send(JSON.stringify(e))},o.x.CVServer.onmessage=e=>{let t=JSON.parse(e.data);i.Y.emit("dlc.handleServerCommand",t)},o.x.CVServer.onerror=()=>{o.x.CVServer=!1,setTimeout((()=>{c.vc.control&&h()}),2e4)},o.x.CVServer.onclose=()=>{o.x.CVServer=!1})};o.x.handleServerCommand=p},601:(e,t,n)=>{n.d(t,{mi:()=>p,pj:()=>u,rC:()=>m});var o=n(555),l=n(182),c=n(274),a=n(126);const i=e=>{let t=decodeURI(window.location.href).split("&");for(let n=0;n<t.length;n++){let o=t[n].split("=");if(o[0]==e)return o[1]}return!1},r=(e,t=!1)=>{(0,o.Xi)((()=>e.document.getElementById("avatar-btn")),(n=>{n.click(),(0,o.Xi)((()=>t?e.document.getElementsByClassName("style-scope iron-dropdown")[0].getElementsByTagName("a")[1]:e.document.getElementsByClassName("yt-simple-endpoint style-scope ytd-compact-link-renderer")[0]),(t=>{t.click(),(0,o.Xi)((()=>e.document.getElementById("next-button").children[0].children[0].children[0]),(t=>{t.click(),(0,o.Xi)((()=>e.document.getElementById("personal-account-tile-select-button").children[0].children[0].children[0]),(t=>{t.click();const n=()=>{try{e.location.href,setTimeout(n,3e3)}catch(t){e.close(),window.close()}};n()}))}))}))}))},s=e=>(GM_setValue("createExtraChannels",e),window.open("https://www.youtube.com/create_channel?action_create_new_channel_redirect=true"));var d;const m=()=>{let e;console.log("创建频道页面");const t=(e,t=(()=>{}),n=5)=>{let a=[["h1",{style:"color: red"},`即将创建频道: ${e}`],["h1",{id:"countdown",style:"color: red"},`倒计时: ${n}`],(0,c.h)([["button",{class:"dlc-btn",$click:()=>{clearTimeout(d),GM_setValue("createExtraChannels",""),document.getElementById("countdown").innerText="已取消创建新频道。"}},"取消倒计时"]])],i=n;const r=()=>setTimeout((()=>{i--,document.getElementById("countdown").innerText=`倒计时: ${i}`,0==i?(0,o.Xi)((()=>document.getElementById("PlusPageName")),(n=>{((e,t,n)=>{e.value=n,t()})(n,(()=>{const e=document.getElementsByClassName("consent-checkmark");e.length>0&&(console.log("Found"),e[0].focus(),e[0].click());let n=document.getElementById("submitbutton");n.focus(),n.click(),GM_setValue("createExtraChannels",""),setTimeout((()=>{t()}),2e3)}),e)})):d=r()}),1e3);return d=r(),(0,c.h)("div",{style:`color: ${l.Dc.fontColor}`},a)};(0,o.Xi)((()=>unsafeWindow.dulunche),(()=>{let n=i("channelMain"),o=i("channelExtra");n&&o?(e=n,(0,c.FN)(t(e,(()=>{setTimeout((()=>{window.open("https://www.youtube.com/channel_switcher?next=%2Faccount&feature=settings")}),2e3)})))):(e=GM_getValue("createExtraChannels",""),e&&(GM_setValue("createExtraChannels",""),(0,c.FN)(t(e))))}))},u=()=>{(0,o.Xi)((()=>document.getElementById("avatar-btn")),(()=>{console.log("New UI"),r(window,!0)})),(0,o.Xi)((()=>document.getElementsByClassName("page-info-text text-line")[0].parentElement.parentElement.parentElement.parentElement),(e=>{console.log("OldUI");for(let t=0;t<document.getElementsByClassName("page-info-text text-line").length;t++){let n=document.getElementsByClassName("page-info-text text-line")[t].innerText;if(e=document.getElementsByClassName("page-info-text text-line")[t].parentElement.parentElement.parentElement.parentElement,n.match(/.*@.*/)){let t=window.open(e.href);r(t,!1)}}}))},p=e=>{e||alert("accountName is empty!");let t=window.open("https://www.youtube.com/create_channel");window.focus();let n=()=>setTimeout((()=>{if(console.log(t.location.href),"about:blank"!=t.location.href&&"https://www.youtube.com/?channel_creation_token"!=t.location.href.substr(0,47))if("https://www.youtube.com/"!=t.location.href)(0,c.FN)(`创建1个副频道，频道名为${e}`),t.close(),s(e);else{(0,c.FN)(`创建主频道+1个副频道\n副频道名字为${e}`);const n=s(e);console.log(n),(0,o.Xi)((()=>"https://www.youtube.com/channel/"==n.location.href.substr(0,32)),(()=>{n.close(),(0,c.FN)("副频道创建完成 开始创建主频道");try{const e=t.document.getElementsByClassName("style-scope tp-yt-paper-input")[3];let n=l.vc.accountNames;"accountNames"in a.w&&(n=a.w.accountNames);const o=n[randomInt(0,n.length-1)];(0,c.FN)(`新版界面 - 填入账号名字: ${o}`),e.value=o,e.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0})),e.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0}))}catch(e){}t.document.getElementById("create-channel-button").click(),setTimeout(t.close,5e3)}),1e4)}else n()}),2e3);return n(),t}},126:(e,t,n)=>{n.d(t,{w:()=>c,s:()=>a});var o=n(451);n(182);const l=e=>parseInt(e.replace(/\./g,"")),c=(()=>{let e={version:"4.0.0",logs:"4.0.0: 加载logs失败!",announcement:"独轮车版本信息，云屏蔽词加载失败\n可能是春节期间github被墙的关系\n开启全局代理后刷新网页，应该就能正确拖取了。",regexs:[],block_words:[],prefixes:[],suffixes:[],ytb_block_words:[],replace_words:{},phantom_tank:!1};try{let t,n=new XMLHttpRequest;n.open("GET","https://raw.githubusercontent.com/aserwarsdfd/logs/main/a.json",!1),n.send(),t=JSON.parse(n.responseText),e.version=t.version,e.announcement=t.announcement,n=new XMLHttpRequest,n.open("GET","https://raw.githubusercontent.com/aserwarsdfd/logs/main/b.json",!1),n.send(),t=JSON.parse(n.responseText),e.regexs=t.regexs,e.replace_words=t.replace_words,e.ytb_block_words=t.ytb_block_words,e.prefixes=t.prefixes,e.suffixes=t.suffixes,l(GM_info.script.version)<l(e.version)&&(n=new XMLHttpRequest,n.open("GET","https://raw.githubusercontent.com/aserwarsdfd/logs/main/l.json",!1),n.send(),t=JSON.parse(n.responseText),e.logs=t.logs),n=new XMLHttpRequest,n.open("GET","https://raw.githubusercontent.com/aserwarsdfd/logs/main/name.txt",!1),n.send(),t=n.responseText.split("\n").map((e=>e.substr(0,e.length>50?50:e.length))).filter((e=>e.length>10)),t.length>0&&(e.accountNames=t)}catch(e){console.log(e)}return e})(),a=(e=>{if(!e)return{};let t={};return e.forEach((e=>{let n=(0,o.v)(e),l=t;for(let e=0;e<n.length&&l;e++)e==n.length-1?l[n[e]]=!1:(n[e]in l||(l[n[e]]={}),l=l[n[e]])})),t})(c.ytb_block_words.concat(c.block_words))},996:(e,t,n)=>{n.d(t,{Y:()=>_,T:()=>C});var o=n(803),l=n(182),c=n(144),a=n(555),i=n(274);o.x.sendMsg=e=>{o.x.chatTxtInput.textContent=e,o.x.chatTxtInput.dispatchEvent(new InputEvent("input")),o.x.sendBtn.click()},o.x.sendMsgVideo=e=>{document.getElementById("placeholder-area").click();let t=document.getElementsByClassName("style-scope ytd-button-renderer style-primary size-default")[0],n=document.getElementById("contenteditable-root");n.textContent=e,n.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0})),n.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0})),t.click()};var r=n(750),s=n(601),d=n(125),m=n(368),u=n(659);const p=()=>{const{autoSetupURL:e}=l.vc;e&&(l.vc.url=window.location.href),l.vc.url=(0,a.$t)(l.vc.url.split("&")[0]),l.vc.url.match(/.*:\/\/www\.youtube\.com\/watch.*/)?(l.vc.autoDownVote=!0,l.vc.changeChannelCount=0,l.vc.changeChannelTimerstamp=Date.now(),o.x.autoDownVoteBtn.innerText="加特林停火",console.log("加特林启动"),(0,m.L)(!1,!0,u.w7)):(0,i.FN)("请在油管直播间使用这个功能！")},h=()=>{l.vc.autoDownVote=!1,l.vc.changeChannelCount=0,o.x.autoDownVoteBtn.innerText="加特林开火",_.emit("dlc.stop"),void 0!==u.MB&&clearTimeout(u.MB),void 0!==u.RB&&clearTimeout(u.RB)},g=()=>{const{fireMode:e}=l.vc;o.x.fetchNative||(o.x.fetchNative=document.getElementById("chatframe").contentWindow.fetch,document.getElementById("chatframe").contentWindow.fetch=async function(...t){let n;const l="string"==typeof t[0]?t[0]:t[0].url;let c;try{c=new URL(l).pathname}catch(e){c=""}return c.endsWith("/send_message")&&1==e?(o.x.armorPiercingTimeoutId&&(clearTimeout(o.x.armorPiercingTimeoutId),o.x.armorPiercingTimeoutId=void 0),o.x.armorPiercingTimeoutId=setTimeout((()=>{null===o.x.armorPiercingResolve||void 0===o.x.armorPiercingResolve||o.x.armorPiercingResolve(),o.x.armorPiercingTimeoutId=void 0,o.x.armorPiercingPromise=void 0,o.x.armorPiercingResolve=void 0}),233),o.x.armorPiercingPromise||(o.x.armorPiercingPromise=new Promise((e=>{o.x.armorPiercingResolve=e}))),n=await o.x.armorPiercingPromise.then((()=>o.x.fetchNative.apply(this,t)))):n=await o.x.fetchNative.apply(this,t),n})};let b;const f={0:e=>[e.substr(0,l.vc.maxDanmakuLength)],2:e=>e.split("\n").map((e=>e.trim().substr(0,l.vc.maxDanmakuLength))).filter(Boolean),1:e=>{const{maxDanmakuLength:t,minDanmakuLength:n,splitChar:o}=l.vc,c=[];return e.trim().replace(/\s+/g," ").split(new RegExp(`(?<=[${o.replace(/(\\|])/g,"\\$1")}])`)).reduce(((e,o,l,a)=>{for(e+=o;e.length>t;)c.push(e.substr(0,t)),e=e.substr(t);return l===a.length-1?(c.push(e),""):e.length<n?e:(c.push(e),"")}),""),c}},x=()=>{const{autoDownVote:e,maxCycleSec:t,minCycleSec:n,minDownVoteMin:r,maxDownVoteMin:s,minChangeChannel:d,text:m,splitMode:p,randomDanmaku:h,fireMode:x,textAmmoPiecing:v,fireImmediately:y}=l.vc;if(!e)if(unsafeWindow.waitForDownvote&&!u.RB){let e=(0,a.Iy)(1e3*r,1e3*Math.max(r,s));(0,i.FN)(`舰载机挂踩插件运行中 - 过${e/1e3}s点踩。为了保证挂踩时间，涉及到切换频道的操作均会被推迟。`),u.RB=setTimeout((()=>{(0,a.Ux)(!1)}),e),o.x.dlcDownvoteEndTime=(new Date).getTime()+e+1e3*d}else(0,a.Ux)();if(!l.vc.noValidate)try{o.x.configValidators.forEach((e=>e()))}catch(e){(0,i.FN)(e)}let w;if(localStorage.setItem(l.vc.configName,JSON.stringify(l.vc)),0==x){const e=f[p](m);w=o.x.remoteDanmakuConfig.filter(Boolean).reduce(((e,t)=>e.concat(t.list)),e)}else l.vc.ammoPiecingTimes>10&&((0,i.FN)("穿甲弹同时开火次数不要大于10，会被风控射不出来, 已经帮你改小了"),l.vc.ammoPiecingTimes=10),w=f[p](v).map((e=>(0,c.l)(e)));if(!w.length)return void(0,i.FN)("当前弹幕列表为空！");try{g()}catch(e){}o.x.runBtn.innerText="中止";const k=parseInt(1e3*n,10),C=parseInt(1e3*t,10);o.x.danmakuGener=function*(){if(2==+p&&h)for(;;)yield w[(0,a.Iy)(0,w.length-1)];else for(;;)yield*w}();let T=0==x?1:l.vc.ammoPiecingTimes,E=(e=!1)=>{let t=k,n=C;e&&y&&(t=1e3,n=1e3),b=setTimeout((async()=>{try{let e=document.getElementById("comments");if(e&&e.hidden||o.x.sendBtn)if(o.x.chatTxtInput)for(let e=0;e<T;e++)_.emit("dlc.sendMsg",(await o.x.danmakuGener.next()).value);else console.log("似乎是会限，尝试加载发送框"),setTimeout((async()=>{const e=await o.x.init();e?(console.log(e),(0,i.FN)(`蝗虫出洞！往死里打  出洞时间: ${new Date}`)):console.log("尚未出洞")}),500);else _.emit("dlc.sendMsgVideo",(await o.x.danmakuGener.next()).value)}catch(e){}b&&E()}),(0,a.Iy)(t,n))};E(beg=!0)},v=()=>{o.x.runBtn.innerText="出动",o.x.ambushBtn.innerText="伏击",o.x.fetchNative&&(document.getElementById("chatframe").contentWindow.fetch=o.x.fetchNative),o.x.fetchNative=void 0,clearTimeout(b),b=null};let y="";const w=()=>{(0,a.Ux)(),(0,i.FN)("准备伏击 越共探头.jpg"),o.x.ambushBtn.innerText="撤退";const e=unsafeWindow.frames.chatframe.contentDocument.getElementsByTagName("yt-live-chat-text-message-renderer");e&&e.length>0&&(y=e[e.length-1].id);const t=()=>{b=setTimeout((()=>{let e=!1;const n=unsafeWindow.frames.chatframe.contentDocument.getElementsByTagName("yt-live-chat-text-message-renderer");for(let t=n.length-1;t>=0;t--){const l=n[t];if(l.id==y)break;if("Coco Ch. 桐生ココ"===l.getElementsByTagName("yt-live-chat-author-chip")[0].children["author-name"].innerText&&"出动"===o.x.runBtn.innerText){const t=l.textContent||l.innerText;(0,i.FN)(`${String(new Date)}发现目标！开火！${t}`),e=!0,o.x.runBtn.click()}}n&&n.length>0&&(y=n[n.length-1].id),e||t()}),2e3)};t()},k=()=>{o.x.ambushBtn.innerText="伏击",_.emit("dlc.stop")},_={ee:new EventTarget,on(e,t,n,o=Symbol("dlc.event.type.anonymous")){return this.fnMap.set(o,t),this.ee.addEventListener(e,t,n),o},off(e,t,n){this.ee.removeEventListener(e,t,n)},emit(e,t){const n=new CustomEvent(e,{detail:t});this.ee.dispatchEvent(n)},fnMap:new Map},C=()=>{_.on("dlc.ready",(()=>{o.x.autoPlayBtn&&o.x.autoPlayBtn.active&&o.x.autoPlayBtn.click()})),_.on("setRef.remoteDanmakuConfig",(({detail:e})=>{o.x.remoteDanmakuConfig=e})),_.on("dlc.sendMsg",(({detail:e})=>{const{recallMsg:t,fireMode:n}=l.vc;let i=((e,t)=>{let n=t?(0,c.l)(e):e;return o.x.sendMsg(n),(e=>{l.vc.recallMsg&&(console.log("Auto recall"),setTimeout((()=>{const t=unsafeWindow.frames.chatframe.contentDocument.getElementsByTagName("yt-live-chat-text-message-renderer");for(let n=t.length-1;n>=0;n--){const o=t[n],l=o.children[1].children[2].innerText;if(e.trim()===l){o.children[2].children[0].click(),(0,a.Xi)((()=>unsafeWindow.frames.chatframe.contentDocument.getElementsByTagName("ytd-menu-popup-renderer")[0].children[0].children),(e=>{1==e.length&&e[0].click()}),500);break}}}),1e4))})(n),n})(e,0==n);t&&setTimeout((()=>{_.emit("dlc.recallMsg",i)}),2e4)}),{},"dlc.sendMsg.default"),_.on("dlc.sendMsgVideo",(({detail:e})=>{(e=>{o.x.sendMsgVideo(e)})(e)}),{},"dlc.sendMsg.default"),_.on("dlc.handleServerCommand",(({detail:e})=>{(0,r.S)(e)}),{},"dlc.handleServerCommand.default"),_.on("dlc.createChannel",(({detail:e})=>(0,s.mi)(e)),{},"dlc.createChannel.default"),_.on("dlc.ready",d.k$),_.on("dlc.controlOnchange",(()=>{l.vc.control=!l.vc.control,localStorage.setItem(l.vc.configName,JSON.stringify(l.vc)),l.vc.control&&!m.K.inited&&(0,m.L)()}),{},"dlc.controlOnchange.default"),_.on("dlc.run",x,{},"dlc.run.default"),_.on("dlc.stop",v,{},"dlc.stop.default"),_.on("dlc.gatlingrun",p,{},"dlc.gatlingrun.default"),_.on("dlc.gatlingstop",h,{},"dlc.gatlingstop.default"),_.on("dlc.ambush",w,{},"dlc.ambush.default"),_.on("dlc.retreat",k,{},"dlc.retreat.default")}},659:(e,t,n)=>{n.d(t,{RB:()=>s,MB:()=>d,w7:()=>u});var o=n(555),l=n(182),c=n(803),a=n(996),i=n(274),r=n(368);let s,d;const m=(e,t)=>{const{autoDownVote:n,cycleCheck:o,gatlingAutoStop:c}=l.vc;if((0,i.FN)(`此频道点踩完毕，过${t/1e3}s换号`),l.vc.channelsIndexCurr=(l.vc.channelsIndexCurr+1)%l.vc.channelsAll.length,!o&&l.vc.channelsIndexCurr==l.vc.channelsIndexStart)return a.Y.emit("dlc.gatlingstop"),localStorage.setItem(l.vc.configName,JSON.stringify(l.vc)),void(c?((0,i.FN)("成功点踩完一圈。停手，并在10s后关闭窗口。"),setTimeout((()=>{window.close()}),1e4)):(0,i.FN)("成功点踩完一圈。停手"));n&&(t>0?d=setTimeout((()=>{n&&e&&(l.vc.changeChannelCount=1,localStorage.setItem(l.vc.configName,JSON.stringify(l.vc)),e.click())}),t):e&&(l.vc.changeChannelCount=1,localStorage.setItem(l.vc.configName,JSON.stringify(l.vc)),e.click()),e||(console.log("账号相关信息"),console.log(r.K),console.log("参数"),console.log(l.vc),alert("出bug了: 加特林找不到下一个频道，无法继续点踩!\n你可以按f12，并点开控制台【账号相关信息】和【参数】，将内容截图给科技组相关人员 \n注意 其中包括个人邮箱信息！请不要公开发布\n敌特就在身边，泄密就在嘴边")))},u=()=>{const{autoDownVote:e,minDownVoteMin:t,maxDownVoteMin:n,minChangeChannel:d,maxChangeChannel:u,autoAttack:p}=l.vc;let h=parseInt((Date.now()-l.vc.changeChannelTimerstamp)/6e4);if(h>15)return(0,i.FN)(`上次延迟点踩在${parseInt(h/60)}小时${parseInt(h%60)}分钟前，加特林可能忘记停火了。因此帮您自动停火`),a.Y.emit("dlc.gatlingstop"),void localStorage.setItem(l.vc.configName,JSON.stringify(l.vc));if(l.vc.changeChannelTimerstamp=Date.now(),p&&"出动"===c.x.runBtn.innerText&&c.x.runBtn.click(),document.getElementsByClassName("style-scope ytd-menu-renderer force-icon-button")[1].classList.contains("style-text")){let l=(0,o.Iy)(1e3*t,1e3*Math.max(t,n));(0,i.FN)(`加特林正在转动，过${l/1e3}s点踩`),s=setTimeout((()=>{e&&((0,o.Ux)(!1),m(r.K.nextChannel,(0,o.Iy)(1e3*d,1e3*Math.max(d,u))))}),l)}else console.log("这个频道点过踩了"),m(r.K.nextChannel,(0,o.Iy)(1e3*d,1e3*Math.max(d,u)))}},125:(e,t,n)=>{n.d(t,{k$:()=>i,$0:()=>r,Bg:()=>d});var o=n(182),l=n(803),c=n(996),a=n(274);const i=()=>{setTimeout((()=>{l.x.offlineStateDiv=document.querySelector(".ytp-offline-slate-main-text"),l.x.offlineStateDiv.innerText?i():(o.vc.autoStop&&l.x.offlineStateDiv.addEventListener("DOMNodeInserted",s),c.Y.emit("live.start"),console.log("Live start"))}),1e4)},r=(e,t,n=!1,l=!1)=>{fetch(e).then((e=>e.json())).then((e=>{if(!e||!e.currentLives)return t.checked=!1,void(0,a.FN)((0,a.h)("monitor",{style:{color:"red"}},["数据格式有误， 请使用正确的api"]));if(l)return void(e.currentLives[0]||(window.location="https://www.youtube.com/"));if(!e.currentLives[0])return void(0,a.FN)("监控中");const{link:n}=e.currentLives[0];n!==o.vc.lastLiveUrl?((0,o.$)("lastLiveUrl",n),window.location=n):(0,a.FN)("刚冲过了, 休息中, 等待监控API刷新")})).catch((e=>{console.error(e),n||(t.checked=!1,(0,o.$)("fullAutomation",!1)),(0,a.FN)((0,a.h)("monitor",{style:{color:"red"}},[`加载错误 ${e}`]))}))},s=e=>{"感谢收看"===e.target.data&&(c.Y.emit("dlc.gatlingstop"),c.Y.emit("live.stop"),window.location="https://www.youtube.com")},d=()=>{setInterval((()=>{try{const e=document.getElementById("chatframe").contentWindow,t=e.document.querySelector("#send-button button"),n=e.document.querySelector("#input.yt-live-chat-text-input-field-renderer");t&&(l.x.sendBtn=t),n&&(l.x.chatTxtInput=n)}catch(e){}}),6e4)}},264:(e,t,n)=>{n.d(t,{y:()=>i,x:()=>r});var o=n(182),l=n(274),c=n(358);const a=(e,t,n=null)=>{const{modList:a}=o.vc;t?(null===n?a.push({modName:e||"未命名MOD",mod:t,activate:!0}):a[n]={modName:e||"未命名MOD",mod:t,activate:!0},localStorage.setItem(o.vc.configName,JSON.stringify(o.vc)),(0,l.FN)("保存MOD成功,请刷新页面以使用"),(0,c.W)()):(0,l.FN)("无效mod")},i=(e={modName:"",mod:""},t=0)=>{const{modName:n,mod:o}=e,c=Boolean(n);return(0,l.h)("form",{style:{"max-width":"500px"},id:"add-mod",$submit:e=>{e.preventDefault(),c?a(e.target.modName.value,e.target.mod.value,t):a(e.target.modName.value,e.target.mod.value)}},[["input",{value:n,type:"text",name:"modName",placeholder:"MOD名称"}],["button",{type:"submit",class:"dlc-btn"},"保存"],["textarea",{value:o,name:"mod",class:"dlc-textarea",placeholder:"扩展脚本，这里的代码会在独轮车初始化前eval执行",style:{width:"100%",height:"300px",overflow:"scroll",whiteSpace:"pre"},form:"add-mod"},o]])},r=(e,t)=>{const n=["input",{type:"checkbox",$click:({target:e})=>{o.vc.modList[t].activate=e.checked,localStorage.setItem(o.vc.configName,JSON.stringify(o.vc))}}];return e.activate&&(n[1].checked="checked"),["div",{style:{display:"flex","justify-content":"flex-end"}},[["span",{style:{"font-size":"15px",flex:1}},e.modName],n,["button",{$click:()=>{(0,l.FN)(i(e,t))}},"编辑"],["button",{$click:()=>{0===t?o.vc.modList.shift():o.vc.modList.splice(t,t),localStorage.setItem(o.vc.configName,JSON.stringify(o.vc)),(0,c.W)()}},"删除"]]]}},358:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{W:()=>modManager,l:()=>runMods});var _config_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(182),_modules_ui_utils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(274),_modules_mod_mod_edit_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(264);const modManager=(e="singletonDom")=>{const{modList:t}=_config_js__WEBPACK_IMPORTED_MODULE_0__.vc;modManager[e]&&modManager[e].remove();const n=(0,_modules_ui_utils_js__WEBPACK_IMPORTED_MODULE_1__.h)("div",{class:"dlc-mod-mgr"},[["button",{class:"dlc-btn",$click:()=>{n.remove()}},"关闭"],["button",{class:"dlc-button",$click:()=>{(0,_modules_ui_utils_js__WEBPACK_IMPORTED_MODULE_1__.FN)((0,_modules_mod_mod_edit_js__WEBPACK_IMPORTED_MODULE_2__.y)())}},"添加mod"],...t.map(_modules_mod_mod_edit_js__WEBPACK_IMPORTED_MODULE_2__.x)]);modManager[e]=n,document.body.appendChild(n)},runMods=()=>{if(_config_js__WEBPACK_IMPORTED_MODULE_0__.vc.modList)try{_config_js__WEBPACK_IMPORTED_MODULE_0__.vc.modList.forEach((_mod=>{_mod.activate&&eval(_mod.mod)}))}catch(e){console.error(e),(0,_modules_ui_utils_js__WEBPACK_IMPORTED_MODULE_1__.FN)("扩展脚本运行失败，错误信息已输出到控制台")}}},144:(e,t,n)=>{n.d(t,{l:()=>d,e:()=>s});var o=n(182),l=n(451),c=n(555),a=n(126);const i=(e,t)=>{e=e.filter((e=>!/[\u2E80-\u9FFF]/.test(e)));let n=[];for(let o=0;o<e.length;o++){let l=e[o];if(/[A-Za-z]/.test(l))switch(+t){case 0:break;case 1:const e=(0,c.Iy)(0,l.length-1);let o=l.codePointAt(e);90===o?o=65:122===o?o=97:o+=1;let i=l.slice(0,e)+String.fromCodePoint(o)+l.slice(e+1,l.length);try{a.w.block_words.indexOf(i.toLowerCase())>-1||n.push(i)}catch(e){n.push(i)}break;default:console.log(`屏蔽词：${l} 模式: ${t} 尚未编写`)}else n.push(l)}return n},r="いうえおうをかきくけこうさしすせそうなにぬねのはへほうみむめももうやゆよようらりるれろろうがぎぐげごうじだでどうばびぶべぼういてからことしてしたする",s=(e,t=!1,n=!1,o=!1,s=!1,d=!1,m=!1,u=!1,p=!1)=>{let h=[],g=[],b=e.match(/:[a-zA-Z_]+:/);if(b){do{g.push(e.substr(0,b.index)),h.push(b[0]),b=(e=e.substr(b.index+b[0].length)).match(/:[a-zA-Z_]+:/)}while(b);g.push(e)}else g.push(e);if(g=g.map((e=>{if(n&&(e=(e=>{e=(e=(e=(e=e.replace(/’|‘/g,"'").replace(/“|”/g,'"')).replace(/【/g,"[").replace(/】/g,"]").replace(/｛/g,"{").replace(/｝/g,"}")).replace(/，、/g,",").replace(/：/g,":")).replace(/。/g,".").replace(/：/g,":");let t="";for(let n=0;n<e.length;n++)12288!==e.codePointAt(n)?e.codePointAt(n)>65280&&e.codePointAt(n)<65375?t+=String.fromCharCode(e.codePointAt(n)-65248):t+=String.fromCharCode(e.codePointAt(n)):t+=String.fromCharCode(e.codePointAt(n)-12256);return t})(e)),s&&(e=(e=e.toLowerCase()).replace(/[[\]?.!-;,:',，。、“”！？"]+/g," ")),n)for(let t in a.w.regexs)e=e.replace(new RegExp(t),a.w.regexs[t]);let t=(0,l.v)(e);return n&&(t=((e,t,n)=>{let o=[],l=0,c=0,a=!1,r=!1,s=t;for(l=0;l<e.length;l++){if(a)if(s){if(r&&!/[A-Za-z]/.test(e[l])&&!/[\u2E80-\u9FFF]/.test(e[l]))continue;if(e[l].toLowerCase()in s)s=s[e[l].toLowerCase()];else{for(a=!1,s=t;c<l;c++)o.push([e[c]]);l--}}else o.push(i(e.slice(c,l),n)),a=!1,s=t,l-=1;else e[l].toLowerCase()in s?(c=l,a=!0,s=s[e[l].toLowerCase()]):o.push([e[l]]);/[A-Za-z]/.test(e[l])&&(r=!0),/[\u2E80-\u9FFF]/.test(e[l])&&(r=!1)}if(a)if(s)for(;c<l;c++)o.push([e[c]]);else o.push(i(e.slice(c,l),n));return o.reduce(((e,t)=>e.concat(t)),[])})(t,a.s,d)),m&&(t=t.map((e=>e+r[(0,c.Iy)(0,r.length)]))),t.join("")})),o){let e=(0,c.Iy)(0,g.length-1);g[e]=(e=>{const t=e.trim().split(/\s{1,}/);if(t.length>0){const e=(0,c.Iy)(0,t.length-1),n=[...t[e]];n.splice((0,c.Iy)(0,n.length-1),1),t[e]=n.join("")}return t.join(" ")})(g[e])}e=g[0];for(let t=0;t<h.length;t++)e=e+h[t]+g[t+1];if(u&&(e=a.w.prefixes[(0,c.Iy)(0,a.w.prefixes.length-1)]+e),p){const t=a.w.suffixes[(0,c.Iy)(0,a.w.suffixes.length-1)];e.length+t.length>200?e=e.substr(0,200-t.length)+t:e+=t}else e.length>200&&(e=e.substr(0,200));return e},d=e=>{const{ammoRefine_Cloud:t,ammoRefine_Local:n,ammoRefine_Disturb:l,ammoRefine_ToLower:c,ammoRefine_BanedWordMode:a,ammoRefine_SplitWord:i,ammoRefine_prefix:r,ammoRefine_suffix:d}=o.vc;return s(e,t,n,l,c,a,i,r,d)}},451:(e,t,n)=>{n.d(t,{v:()=>c});const o=/([^A-Za-z0-9\u2E80-\u9FFF])/,l=/([\u2E80-\u9FFF])/,c=e=>e?e.split(o).reduce(((e,t)=>e.concat(t.split(l).filter((e=>e)))),[]):[]},484:(e,t,n)=>{n.d(t,{n:()=>a});var o=n(274),l=n(182),c=n(555);const a=(e,t,n,a="")=>{let i=(0,c.Uo)(e)<(0,c.Uo)(t),r=[];return a&&(r=r.concat([(0,o.$g)(l.Dc.border,"2px"),["h1",{style:`color: ${l.Dc.announcementHeader}`},"车载地下电台"]]).concat(a.split("\n").map((e=>["div",{},e])))),r=r.concat([(0,o.$g)(l.Dc.border,"2px"),["h1",{style:"color: red"},i?"更新提示: ":""],["div",{},i?`您的版本为: ${e}, 最新版为: ${t}, 建议更新最新版`:"您的独轮车是最新版，不需要更新"],(0,o.h)([["button",{class:"dlc-btn",$click:()=>{window.location.href=`https://script.cocosuki.xyz/${l.vc.o?"jianzaiji":"cheche"}.user.js`}},i?"更新版本(源1)":"重新安装(源1)"]]),(0,o.h)([["button",{class:"dlc-btn",title:"尚未实装",$click:()=>{}},i?"更新版本(备用源)":"重新安装(备用源)"]]),(0,o.h)([["button",{class:"dlc-btn",$click:()=>{window.open("https://bbs.nga.cn/read.php?tid=25560549")}},"冲蝗指南"]]),(0,o.h)([["button",{class:"dlc-btn",$click:()=>{window.location.href="https://bbs.nga.cn/read.php?tid=25006545"}},"问题反馈"]])]),i&&(n=n.filter((t=>(0,c.Uo)(t.split(":")[0])>(0,c.Uo)(e))),r=r.concat([(0,o.$g)(l.Dc.border,"2px"),["h2",{style:`color: ${l.Dc.announcementHeader}`},"更新日志: "],["div",{},n.map((e=>["div",{},[["h3",{},e.split(":")[0]],["div",{},e.split(":")[1].split("\n").map((e=>["div",{},e]))],(0,o.$g)("#808080","1px")]]))]])),(0,o.h)("div",{style:`color: ${l.Dc.fontColor}`},r)}},274:(e,t,n)=>{n.d(t,{h:()=>a,FN:()=>i,$g:()=>r,bE:()=>s,y7:()=>d,JJ:()=>m});var o=n(182),l=n(996),c=n(555);const a=(e,t={},n=[],o={})=>{if(e instanceof Node)return e;if(e instanceof Array){const t=document.createDocumentFragment();return e.forEach((e=>{e instanceof Node?t.appendChild(e):Array.isArray(e)?t.appendChild(a(e[0],e[1],e[2],e[3])):(["string","number"].includes(typeof e)||e)&&t.appendChild(new Text(e))})),t}const l=document.createElement(e);return Object.entries(t).forEach((([e,t])=>{"style"===e&&"object"==typeof t?Object.assign(l.style,t):e.startsWith("$")?"function"==typeof t?l.addEventListener(e.slice(1),t):l.addEventListener(e.slice(1),t.handleEvent,t):l.setAttribute(e,t)})),["string","number"].includes(typeof n)?l.textContent=n:n&&l.appendChild(a(n)),"function"==typeof o?o(l):o.cb&&o.cb(l),l},i=(e,t="dlc-toast",n="singletonDom",o=(()=>{}))=>{i[n]&&i[n].remove();const l=a("div",{class:t,style:{zIndex:++i.currZIndex}},[["button",{class:"dlc-btn",$click:()=>{l.remove(),i[n]=null,o()}},"关闭"],["div",{style:"font-size: 120%;"},e]]);"dlc-alert"===t&&setTimeout((()=>l.remove()),1e4),i[n]=l,document.body.appendChild(l)};i.currZIndex=1e4;const r=(e,t)=>["div",{style:`height: 1px;border-top: ${t} solid ${e}; text-align: center;`},""],s=({label:e,type:t,name:n,props:c={},children:a=[],valueProp:r="value",helpDesc:s},d)=>["div",{},[s&&["span",{class:"help-icon",$click:e=>{e.stopPropagation(),i(s)}}],["label",{},[e,[t,{...c,$change:e=>{l.Y.emit(`setConfig.${n}`,e.target[r]),c.$change&&c.$change(e)}},a,e=>{e[r]=o.vc[n],l.Y.on(`setConfig.${n}`,(({detail:t})=>{o.vc[n]=t,e[r]=t}),{},`dlc.setConfig.${n}.default`)}]]]],d],d=(e,t,n="")=>(t[0][1].style=`border-top:1px solid;border-top-left-radius: 5px;border-top-right-radius: 5px;${t[0][1].style}`,t[t.length-1][1].style=`border-bottom:1px solid;border-bottom-left-radius: 5px;border-bottom-right-radius: 5px;${t[t.length-1][1].style}`,["div",{},[n&&["span",{class:"help-icon",$click:e=>{e.stopPropagation(),i(n)}}],["label",{},[["details",{},[["summary",{style:`background-color: ${o.Dc.collapseBackground1};border:1px solid;border-radius:5px;border-color: ${o.Dc.collapseBorder};`},e]].concat(t.map((e=>(e[1].style=`background-color: ${o.Dc.collapseBackground2};border-right:1px solid; border-left:1px solid;border-color: ${o.Dc.collapseBorder};${e[1].style}`,e))))]]]]]),m=(e,t="测试用定型文",n=!1)=>["div",{},[[a([["button",{class:"dlc-btn",$click:()=>{(0,c.qb)(t,"",!1)}},"复制"],["label",{},[e]]])]]]},803:(e,t,n)=>{n.d(t,{x:()=>a,d:()=>i});var o=n(182),l=n(996),c=n(274);const a={sendBtn:null,autoDownVoteBtn:null,chatTxtInput:null,autoPlayBtn:null,runBtn:null,runAmmoTestBtn:null,runAmmoAnalysisBtn:null,offlineStateDiv:null,remoteDanmakuConfig:[],dlcAutomation:null,duluncheWnd:null,CVServer:!1,dlcDownvoteEndTime:0,fetchNative:void 0,armorPiercingTimeoutId:void 0,armorPiercingPromise:void 0,armorPiercingResolve:void 0,configValidators:[()=>Number(o.vc.minCycleSec)<1&&l.Y.emit("setConfig.minCycleSec",1),()=>Number(o.vc.minDanmakuLength)<1&&l.Y.emit("setConfig.minDanmakuLength",1),()=>Number(o.vc.maxDanmakuLength)<o.vc.minDanmakuLength&&l.Y.emit("setConfig.maxDanmakuLength",o.vc.minDanmakuLength)],danmakuGener:null,configFieldContainer:null,helpContent:null,init:async()=>{try{const e=document.getElementById("chatframe").contentWindow;return a.sendBtn=e.document.querySelector("#send-button button"),a.chatTxtInput=e.document.querySelector("#input.yt-live-chat-text-input-field-renderer"),a.offlineStateDiv=document.querySelector(".ytp-offline-slate-main-text"),a.autoPlayBtn=document.querySelector("paper-toggle-button"),!(!a.sendBtn||!a.chatTxtInput)}catch(e){return!1}}};a.helpContent=[["button",{class:"dlc-btn",$click:()=>{(0,c.FN)("老版独轮车扩展脚本已经迁移到MOD管理, 并且会在未来版本中删除")}},"编辑扩展脚本"],["pre",{},"\n  API开发指南，在window.dulunche获取引用，TS定义如下\n  /**\n  * 独轮车配置，这是一个Proxy对象，你可以直接获取和设置配置，通过这个对象设置配置项时，也会向eventBus提交一个emit(`setConfig.${配置项名称}`, value)事件\n  * config对象在每次启动时会保存到localStorage的duluncheCfg中\n  */\n  interface ConfigType {\n  /** 断句方式0: 单句模式 1: 说书模式 2: 多句转轮 */\n  splitMode: number;\n  /** 最小发送间隔（秒） */\n  minCycleSec: number;\n  /** 最大发送间隔（秒） */\n  maxCycleSec: number;\n  /** 是否随机发送 */\n  randomDanmaku: boolean;\n  /** 发送消息列表 */\n  text: string;\n  /** 最大弹幕字数限制 */\n  maxDanmakuLength: number;\n  /** 最小弹幕长度 */\n  minDanmakuLength: number;\n  /** 断句符 */\n  splitChar: string;\n  /** 远程弹幕库 */\n  remoteDanmakuBase: string;\n  /** 不校验配置，即不运行configValidators, 设为true是，所有配置项都不会限制输入范围 */\n  noValidate: boolean;\n  /** 扩展脚本，独轮车初始化前会eval执行这个脚本 */\n  extension: string;\n\n  [key: string]: any;\n  }\n\n  /**\n  * 独轮车事件总线，可以在这里监听和触发各种事件\n  */\n  interface DuluncheEventBus {\n  /** 用来绑定事件的EventTarget对象，通常不需要直接操作这个对象 */\n  ee: EventTarget;\n  /** 监听事件，addEventListener, 会返回一个key用于从fnMap获取监听器引用，这个key可以手动指定，默认是一个Symbol */\n  on<T = any>(\n  type: string,\n  fn: (detail: CustomEvent<T>) => void,\n  opt?: boolean | AddEventListenerOptions, fnKey?: string | Symbol\n  ): string | Symbol;\n  /** 取消监听事件，removeEventListener */\n  off<T = any>(type: string, fn: (detail: CustomEvent<T>) => void, opt?: boolean | AddEventListenerOptions): any;\n  /** 触发事件，dispatchEvent */\n  emit<T = any>(type: string, detail: T): void;\n  /** 已经注册的事件监听器map，可以通过key拿到事件监听器的引用 */\n  fnMap: Map<string | Symbol, (detail: CustomEvent) => void>;\n  }\n\n  /** 独轮车内部一些引用，修改它们可以改变独轮车原本的一些行为 */\n  interface DuluncheRefs {\n  /** 配置项校验器，独轮车会在dlc.run开始时依次执行数组中的每个函数 */\n  configValidators: Array<() => void>\n  /** 独轮车控制台窗口dom引用 */\n  duluncheWnd: HTMLDivElement;\n  /** 独轮车配置列表dom引用 */\n  configFieldContainer: HTMLDivElement;\n  /** 弹幕生成器，独轮车通过调用danmakuGener.next().value来获取下一条要发送的弹幕，弹幕生成器只能在独轮车启动状态下被替换，最早是dlc.run的下一次事件循环 */\n  danmakuGener: GeneratorFunction;\n  /** 独轮车帮助信息内容 */\n  helpContent: any;\n  /** 初始化函数，若没有返回true则会等待1秒后重新执行，初始化成功会触发dlc.ready事件，默认行为是获取油管直播页聊天输入框和发送按钮引用，可以是异步函数 */\n  init: () => boolean | Promise<boolean>;\n\n  [key: string]: any;\n  }\n\n  interface Window {\n  dulunche: {\n  config: ConfigType;\n  eventBus: DuluncheEventBus,\n  refs: DuluncheRefs,\n\n  /** 组件和渲染器，建议看过源码后使用 */\n  components: {\n  Toast: (children: string | Node, singletonId?: string) => void;\n  ConfigField: (...args: any) => HTMLDivElement;\n  h: (...args: any) => Node;\n  }\n  };\n  }\n\n  /**\n  eventBus 默认的事件列表, 你可以通过emit主动触发事件，或通过on监听事件\n  事件名 | 事件 | detail参数类型 | detail参数说明\n  dlc.run | 启动独轮车 | void | -\n  dlc.stop | 停止独轮车 | void | -\n  dlc.sendMsg | 发送消息 | string | 发送的内容\n  dlc.ready | 初始化成功 | void | -\n  setConfig.${configKey} | 修改配置 | any | 修改的配置值\n  live.start| 监控到直播已经开始 | void\n  live.stop | 监控到直播已经结束 | void\n  */\n  "]];const i=async()=>{let e;try{e=await a.init()}catch(e){}!0!==e?setTimeout((()=>i()),1e3):l.Y.emit("dlc.ready")}},555:(e,t,n)=>{n.d(t,{Iy:()=>a,jr:()=>i,qb:()=>r,Uo:()=>s,Ye:()=>d,Xi:()=>m,$t:()=>u,Ux:()=>p,mr:()=>h});var o=n(126),l=n(274),c=n(484);const a=(e,t)=>t<e?e:Math.floor(Math.random()*(t-e+1)+e),i=(e,t)=>e.split("&")[0]===t.split("&")[0],r=(e,t,n=!0)=>{var o=document.createElement("textarea");o.value=e,document.body.appendChild(o),o.select(),document.execCommand("copy"),document.body.removeChild(o),n&&(null==t?alert("复制成功"):alert(t))},s=e=>parseInt(e.replace(/\./g,"")),d=e=>{s(e)<s(o.w.version)&&((0,l.FN)(`您的版本为: ${e}, 最新版为: ${o.w.version}, 建议更新最新版本。\n更新日志: \n    ${o.w.logs}`),(0,l.FN)((0,c.n)(oldVersion=e,newVersion=o.w.version,logs=o.w.logs.split(";"))))},m=(e,t,n=3e3)=>{let o;try{if(o=e(),!o)return void setTimeout((()=>m(e,t,n)),n)}catch(o){return void setTimeout((()=>m(e,t,n)),n)}t(o)},u=e=>{if(e.match(/.*:\/\/youtu\.be\/.*/)){let t=e.split("/");return`${t[0]}//www.youtube.com/watch?v=${t[t.length-1]}`}return e},p=(e=!0)=>{const t=document.getElementById("channel-name").getElementsByClassName("yt-simple-endpoint style-scope yt-formatted-string")[0].text;var n;e&&"Coco Ch. 桐生ココ"!==t&&"kson ONAIR"!==t||"false"===(n=document.getElementsByClassName("style-scope ytd-menu-renderer force-icon-button")[1]).getElementsByTagName("button")[0].getAttribute("aria-pressed")&&n.click()},h=e=>`${Math.floor(e/3600)}:${Math.floor(e/60%60)}:${Math.floor(e%60)}`}},__webpack_module_cache__={};function __webpack_require__(e){if(__webpack_module_cache__[e])return __webpack_module_cache__[e].exports;var t=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](t,t.exports,__webpack_require__),t.exports}__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e=__webpack_require__(555),t=__webpack_require__(182),n=__webpack_require__(803),o=__webpack_require__(996),l=__webpack_require__(274);const c=(e=!0,t=!1)=>{try{const n=document.querySelectorAll("video")[0];e?n.pause():t||n.play();document.querySelector("#player.style-scope").style.display=e?"none":"block"}catch(e){console.log("省流模式出现错误"),console.log(e)}},a=(e=!0)=>{try{let t=[];t.push(document.getElementById("chatframe").contentDocument.getElementById("ticker").style),t.push(document.getElementById("chatframe").contentDocument.getElementById("separator").style),t.push(document.getElementById("chatframe").contentDocument.getElementById("chat").style),t.push(document.getElementById("chatframe").contentDocument.getElementById("toast-container").style),t.forEach((t=>{t.display=e?"none":""}))}catch(e){}},i=(e=!0)=>{try{let t=[];t.push(document.getElementById("meta").style),t.push(document.getElementsByTagName("ytd-watch-next-secondary-results-renderer")[0].style),t.forEach((t=>{t.display=e?"none":""}))}catch(e){}};var r=__webpack_require__(358),s=__webpack_require__(144),d=__webpack_require__(368);let m;const u=(e="",t=((e,t)=>{}))=>{try{2==document.getElementById("chatframe").contentWindow.document.getElementById("action-buttons").querySelectorAll("button").length&&document.getElementById("chatframe").contentWindow.checkSuperChat(e).then((n=>{t(e,(e=>{let t="?";return t="用户未登录或SuperChat不可用"===e.error?"U":null==e.error?"T":"F",t})(n))}),(()=>{}))}catch(e){}},p=()=>{const{control:e,autoSCCheck:o}=t.vc;if(e||o){if("T"!=d.K.channelState&&"?"!=d.K.channelState)return;u("",((e,t)=>{if(t!=d.K.channelState){d.K.channelState=t;const e=d.K.get(!1);e&&n.x.CVServer&&n.x.CVServer.send(JSON.stringify(e))}}))}"T"!=d.K.channelState&&"?"!=d.K.channelState||(m=setTimeout(p,6e4))};m=setTimeout(p,3e4);var h=__webpack_require__(451);let g,b=new Set;const f=e=>e.match(/([A-Za-z0-9])/)||e.match(/([\u2E80-\u9FFF])/);var x=__webpack_require__(125),v=__webpack_require__(126);let y;const w=(d=GM_info.script.version)=>(0,l.h)("div",{class:"dlc-cmd"},[["div",{class:"dlc-titlebar",$mousedown(e){if(e.target!==this)return;const t=(0,l.h)("div",{style:{position:"fixed",left:"0",top:"0",width:"100vw",height:"100vh"}});this.style.cursor="all-scroll",document.body.appendChild(t);const{layerX:o,layerY:c}=e,a=e=>{n.x.duluncheWnd.style.left=e.clientX-o+"px",n.x.duluncheWnd.style.top=e.clientY-c+"px"};document.addEventListener("mousemove",a),document.addEventListener("mouseup",(()=>{document.removeEventListener("mousemove",a),this.style.cursor="",t.remove()}),{once:!0})}},[["button",{class:"dlc-btn",$click:e=>{e.stopPropagation(),"出动"===n.x.runBtn.innerText?o.Y.emit("dlc.run"):o.Y.emit("dlc.stop")}},"出动",e=>{n.x.runBtn=e}],["span",{class:"help-icon",$click:e=>{e.stopPropagation(),(0,l.FN)(n.x.helpContent)}}],["span",{class:"import-export-icon",title:"复制独轮车参数到剪贴板",$click:n=>{n.stopPropagation(),(0,e.qb)(JSON.stringify(t.vc))}},"",e=>{e.insertAdjacentHTML("afterbegin",'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="display: block;margin: 20%;">\x3c!-- Font Awesome Free 5.15.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\x3e<path d="M296 384h-80c-13.3 0-24-10.7-24-24V192h-87.7c-17.8 0-26.7-21.5-14.1-34.1L242.3 5.7c7.5-7.5 19.8-7.5 27.3 0l152.2 152.2c12.6 12.6 3.7 34.1-14.1 34.1H320v168c0 13.3-10.7 24-24 24zm216-8v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h136v8c0 30.9 25.1 56 56 56h80c30.9 0 56-25.1 56-56v-8h136c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"></path></svg>')}],["span",{class:"import-export-icon",title:"导入独轮车参数",$click:e=>{e.stopPropagation(),(0,l.FN)(((e={newConfig:""})=>{const{newConfig:o}=e;return(0,l.h)("form",{style:{"max-width":"500px"},id:"edit-config",$submit:e=>{let o;e.preventDefault();try{o=JSON.parse(e.target.newConfig.value)}catch(e){return void alert("无法解析输入的参数字符串！建议检查下复制的对不对")}Object.assign(t.vc,o),document.body.removeChild(n.x.duluncheWnd),n.x.duluncheWnd=w(),document.body.appendChild(n.x.duluncheWnd),n.x.duluncheWnd.style.setProperty("display","block"),localStorage.setItem(t.vc.configName,JSON.stringify(t.vc)),(0,l.FN)("设置已保存")}},[["button",{type:"submit",class:"dlc-btn"},"保存"],["textarea",{value:o,name:"newConfig",class:"dlc-textarea",placeholder:"请把复制出的参数粘贴在这儿",style:{width:"100%",height:"50px",overflow:"scroll",whiteSpace:"pre"},form:"edit-config"},o]])})())}},"",e=>{e.insertAdjacentHTML("afterbegin",'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="margin: 20%;display: block;">\x3c!-- Font Awesome Free 5.15.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\x3e<path d="M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"></path></svg>')}],`v${d}`,["div",t.vc.o?{}:{hidden:!0},[["label",{title:"开启/关闭舰载机模式"},[(0,l.bE)({name:"control",type:"input",props:{class:"mui-switch",type:"checkbox",onchange:'window.dulunche.eventBus.emit("dlc.controlOnchange");'},valueProp:"checked"})]]]],["div",{class:"dlc-close-btn",style:"position: absolute; right: 0;",$click:e=>{e.stopPropagation(),n.x.duluncheWnd.style.setProperty("display","none")}},"X"]]],["div",{class:"dlc-cmd-list"},[["div",{style:"width: 263px;"},[(0,l.bE)({label:"",name:"text",type:"textarea",props:{class:"dlc-textarea",placeholder:"输入常规模式需要发射的内容到这里",style:{height:"100px",overflow:"scroll",whiteSpace:"pre"}}}),(0,l.bE)({label:"",name:"textAmmoPiecing",type:"textarea",props:{class:"dlc-textarea",placeholder:"输入穿甲弹发射的内容到这里",style:{height:"50px",overflow:"scroll",whiteSpace:"pre"}}}),["div",{},[["button",{class:"dlc-btn",$click:e=>{e.stopPropagation(),"伏击"===n.x.ambushBtn.innerText?o.Y.emit("dlc.ambush"):o.Y.emit("dlc.retreat")}},"伏击",e=>{n.x.ambushBtn=e}],["button",{class:"dlc-btn",$click:e=>{t.vc.control?(0,l.FN)("请先关闭舰载机模式"):(t.vc.autoDownVote?o.Y.emit("dlc.gatlingstop"):o.Y.emit("dlc.gatlingrun"),localStorage.setItem(t.vc.configName,JSON.stringify(t.vc)))}},"加特林开火",e=>{n.x.autoDownVoteBtn=e,t.vc.autoDownVote?n.x.autoDownVoteBtn.innerText="加特林停火":(o.Y.emit("dlc.gatlingstop"),localStorage.setItem(t.vc.configName,JSON.stringify(t.vc)))}],["button",{class:"dlc-btn",$click:()=>{localStorage.setItem(t.vc.configName,JSON.stringify(t.vc)),g&&(clearTimeout(g),g=void 0),(0,l.FN)((()=>{const o=()=>{let e=[],t=document.getElementById("dlc-ammotest-text").children,n=document.getElementById("dlc-ammotest-textAP").children;for(let n=0;n<t.length;n++)e.push(t[n]);for(let t=0;t<n.length;t++)e.push(n[t]);return e};let c=["div",{id:"dlc-ammotest-text"},t.vc.text.split("\n").filter((e=>e.trim())).map((e=>["div",{style:"background-color:#C6C09C;"},e]))],a=["div",{id:"dlc-ammotest-textAP"},t.vc.textAmmoPiecing.split("\n").filter((e=>e.trim())).map((e=>["div",{style:"background-color:#C6C09C;"},e]))];return(0,l.h)("div",{style:{"max-width":"500px"}},[["button",{class:"dlc-btn",$click:()=>{if(g)return clearTimeout(g),g=void 0,n.x.runAmmoTestBtn.innerText="开始测试",n.x.runAmmoAnalysisBtn.innerText="屏蔽词分析",void((t.vc.connect||t.vc.autoSCCheck)&&setTimeout(p,6e4));n.x.runAmmoTestBtn.innerText="测试中",clearTimeout(m),u("",((e,l)=>{if("T"!=l)setTimeout(p,6e4),n.x.runAmmoTestBtn.innerText="开始测试",alert("无法打SC, 可能的原因有 直播间未开启SC/频道被封/频道名有屏蔽词");else{let e=o();if(0==e.length)return;t.vc.tokenRefine&&e.forEach((e=>{e.textContent=(0,s.l)(e.textContent)}));let l=0,c=(o,a)=>{e[l].valid="T"==a;let i=e[l].valid?"#9BC768":"#F583B4";e[l++].style=`background-color: ${i};`,l<e.length&&"测试中"===n.x.runAmmoTestBtn.innerText?t.vc.tokenDelayTime>0?g=setTimeout((()=>{u(e[l].innerText,c)}),t.vc.tokenDelayTime):u(e[l].innerText,c):((t.vc.connect||t.vc.autoSCCheck)&&setTimeout(p,6e4),n.x.runAmmoTestBtn.innerText="开始测试",g=void 0)};u(e[l].innerText,c)}}))}},"开始测试",e=>{n.x.runAmmoTestBtn=e}],["button",{class:"dlc-btn",$click:()=>{const e=e=>{let t=[];for(let n=0;n<e.length;n++)e[n].valid&&t.push(e[n].innerText);return t.join("\n")};let o=document.getElementById("dlc-ammotest-text").children,l=document.getElementById("dlc-ammotest-textAP").children;t.vc.text=e(o),t.vc.textAmmoPiecing=e(l),document.body.removeChild(n.x.duluncheWnd),n.x.duluncheWnd=w(),document.body.appendChild(n.x.duluncheWnd),n.x.duluncheWnd.style.setProperty("display","block")}},"装填可用弹药"],["button",{class:"dlc-btn",$click:()=>{let t=o().filter((e=>null!=e.valid)).map((e=>({text:e.innerText,valid:e.valid}))),n={timestamp:(new Date).getTime(),ammos:t};(0,e.qb)(JSON.stringify(n)),alert("已将SC测试的结果复制到剪贴板。您可以在NGA屏蔽词总结贴中分享您测试的结果。")}},"导出结果"],(0,l.$g)(t.Dc.border,"2px"),(0,l.y7)("高级",[(0,l.bE)({label:"最短屏蔽词长度",name:"tokenLenMin",type:"input",props:{type:"number",min:1,style:{width:"48px",margin:"1px"}},helpDesc:"检查的最短屏蔽词长度"}),(0,l.bE)({label:"最长屏蔽词长度",name:"tokenLenMax",type:"input",props:{type:"number",min:1,style:{width:"48px",margin:"1px"}},helpDesc:"检查的最长屏蔽词长度。更长的就不检查了"}),(0,l.bE)({label:"SC检测间隔时间(ms)",name:"tokenDelayTime",type:"input",props:{type:"number",min:0,style:{width:"48px",margin:"1px"}},helpDesc:"每次SC检测之间的间隔时间"}),(0,l.bE)({label:"检测精炼后弹药",name:"tokenRefine",type:"input",props:{type:"checkbox"},valueProp:"checked",helpDesc:"打SC前先根据当前精炼设置，将弹药精炼。建议开启。"}),["button",{class:"dlc-btn",style:`background-color:  ${t.Dc.btn};`,$click:()=>{if(g)return clearTimeout(g),n.x.runAmmoTestBtn.innerText="开始测试",n.x.runAmmoAnalysisBtn.innerText="屏蔽词分析",g=void 0,void((t.vc.connect||t.vc.autoSCCheck)&&setTimeout(p,6e4));let e=o().filter((e=>null!=e.valid&&!e.valid));if(0==e.length)return;n.x.runAmmoAnalysisBtn.innerText="分析中...",clearTimeout(m),b.clear();let c=document.getElementById("dlc-ammoAnalysis"),a=c.lastElementChild;for(;a;)c.removeChild(a),a=c.lastElementChild;let i=[],r={},s=0;e.forEach((e=>{let n=(0,h.v)(e.innerText),o=[],a=t.vc.tokenLenMax+1;n.length<a&&(a=n.length);let d=[];for(let e=parseInt(t.vc.tokenLenMin);e<a;e++){let t=[];for(let l=0;l<n.length;l++)if(f(n[l]))for(let c=l+e;c<n.length+1;c++)if(f(n[c-1])){let e=n.slice(l,c).join("");o.push(e),t.push({text:e,start:l,end:c,index:s++,parents:[]});break}d.push(t)}let m=o.map((e=>["dt",{style:"background-color:#C6C09C;"},e]));for(let e=0;e<d.length-1;e++){let t=d[e],n=d[e+1];for(let e=0;e<t.length;e++){let o=t[e];r[o.index]=o;for(let e=0;e<n.length;e++){let t=n[e];o.start>=t.start&&o.end<=t.end&&o.parents.push(t)}}}m=[["summary",{style:"background-color:#F583B4;"},e.innerText]].concat(m);let u=(0,l.h)("details",{},m);c.appendChild(u);for(let e=1;e<u.children.length;e++)i.push(u.children[e])}));let d=0,x=(e,o)=>{if(i[d].valid="T"==o,i[d].valid)i[d].style="background-color: #9BC768;";else{b.add(i[d].innerText.trim());let e=[d];for(;e.length>0;){let t=e.pop();if(i[t].valid=!1,i[t].style="background-color: #F583B4;",t in r)for(let n=0;n<r[t].parents.length;n++)e.push(r[t].parents[n].index)}}for(d+=1;d<i.length&&0==i[d].valid;)d+=1;d<i.length?t.vc.tokenDelayTime>0&&"分析中..."===n.x.runAmmoAnalysisBtn.innerText?g=setTimeout((()=>{u(i[d].innerText,x)}),t.vc.tokenDelayTime):u(i[d].innerText,x):((t.vc.connect||t.vc.autoSCCheck)&&setTimeout(p,6e4),clearTimeout(g),g=void 0,n.x.runAmmoAnalysisBtn.innerText="屏蔽词分析")};u(i[d].innerText,x)}},"屏蔽词分析",e=>{n.x.runAmmoAnalysisBtn=e}],["button",{class:"dlc-btn",style:`background-color:  ${t.Dc.btn};`,$click:()=>{0==b.size?alert("列表为空。请先运行屏蔽词分析！"):((0,e.qb)(JSON.stringify([...b])),alert("已将SC测试的结果复制到剪贴板。您可以在NGA屏蔽词总结贴中分享您测试的结果。"))}},"屏蔽词导出"]]),(0,l.$g)(t.Dc.border,"2px"),["div",{},[["div",{},"您可以将弹药检测的结果分享到"],["a",{href:"https://ngabbs.com/read.php?tid=25288041"},"https://ngabbs.com/read.php?tid=25288041"],["div",{},"这样科技组可以从中分析屏蔽词"],["div",{},"屏蔽词分析词语长度最短为2个字符，最长为5个字符。更短/更长的屏蔽词请手动测试"],["div",{},"另外虫直播间除了屏蔽词以外还有白名单词。在测试屏蔽词的时候请多加注意。"]]],(0,l.$g)(t.Dc.border,"2px"),["div",{},[c,(0,l.$g)(t.Dc.border,"2px"),a,(0,l.$g)(t.Dc.border,"2px"),["div",{id:"dlc-ammoAnalysis"},[]]]]])})(),toastClass="dlc-toast",singletonId="ammoSCCheck",onClose=()=>{g&&(clearTimeout(g),g=void 0)})}},"弹药检测"]]],(0,l.bE)({label:"开火模式:",name:"fireMode",type:"select",children:[{value:"0",text:"常规模式"},{value:"1",text:"穿甲模式"}].map((({text:e,value:t})=>["option",{value:t},e])),helpDesc:"常规模式:正常开火；穿甲模式: 连续开火，击穿慢速护甲"}),(0,l.bE)({label:"穿甲弹开火次数:",name:"ammoPiecingTimes",type:"input",props:{type:"number",min:1,max:10,placeholder:1,style:{width:"48px",margin:"1px"}},helpDesc:"穿甲弹同时开火的次数，越多穿甲效果越明显，但是也会增加被google风控的概率"},(e=>{1!=+t.vc.fireMode&&e.classList.add("hide"),o.Y.on("setConfig.fireMode",(({detail:t})=>{"1"!==t?e.classList.add("hide"):e.classList.remove("hide")}),{},"dlc.setConfig.fireMode.ammoPiecingTimesField")})),(0,l.bE)({label:"最小间隔时间(s):",name:"minCycleSec",type:"input",props:{type:"number",min:3,placeholder:3,style:{width:"48px",margin:"1px"}},helpDesc:"如果最大间隔时间设置小于最小间隔时间，则相当于不随机间隔，以最小间隔时间发送弹幕"}),(0,l.bE)({label:"最大间隔时间(s):",name:"maxCycleSec",type:"input",props:{type:"number",min:3,placeholder:3,style:{width:"48px",margin:"1px"}},helpDesc:"如果最大间隔时间设置小于最小间隔时间，则相当于不随机间隔，以最小间隔时间发送弹幕"}),(0,l.bE)({label:"自动停车",name:"autoStop",type:"input",props:{type:"checkbox"},valueProp:"checked",helpDesc:"自动刹车，可能有bug"},(()=>{o.Y.on("setConfig.autoStop",(({detail:e})=>{if(e)n.x.offlineStateDiv.addEventListener("DOMNodeInserted",bindStop);else try{n.x.offlineStateDiv.removeEventListener("DOMNodeInserted",bindStop)}catch(e){}}))})),(0,l.bE)({label:"自动SC检测",name:"autoSCCheck",type:"input",props:{type:"checkbox"},valueProp:"checked",helpDesc:"勾选后此独轮车每分钟会自动进行sc检测"}),(0,l.bE)({label:"关闭配置项校验:",name:"noValidate",type:"input",props:{type:"checkbox"},valueProp:"checked",helpDesc:"不对输入的配置项进行校验，这意味着你可以进行将间隔时间设置为0这样的危险操作"}),(0,l.y7)("开火设置: 和开火有关的各个设置",[(0,l.bE)({label:"立刻开火",name:"fireImmediately",type:"input",props:{type:"checkbox"},valueProp:"checked",helpDesc:"建议勾选。勾选后点击出动会在一秒后立刻开火，否则则会等待一轮间隔时间后再开火"}),(0,l.bE)({label:"自动撤回",name:"recallMsg",type:"input",props:{type:"checkbox",onchange:'window.dulunche.eventBus.emit("dlc.recallModeOnchange");'},valueProp:"checked",helpDesc:"自动撤回发出的弹药迷惑扳手，注意！请设置较长的开火时间间隔（最短5s以上），此功能能否生效受电脑卡顿因素影响，不要依赖这个开火"},(e=>{o.Y.emit("dlc.recallModeOnchange")})),(0,l.bE)({label:"断句方式:",name:"splitMode",type:"select",children:[{value:"2",text:"多句转轮"},{value:"0",text:"单句模式"},{value:"1",text:"说书模式"}].map((({text:e,value:t})=>["option",{value:t},e])),helpDesc:"多句转轮:每条弹幕一行；单句模式:不断行；说书模式:按表单符号与说书长度下限断行"}),(0,l.bE)({label:"随机弹幕:",name:"randomDanmaku",type:"input",props:{type:"checkbox"},valueProp:"checked",helpDesc:"随机弹幕: 是否随机从弹幕列表选取弹幕发送，仅用于多句转轮模式；在说书模式启用会导致内容混乱"},(e=>{2!=+t.vc.splitMode&&e.classList.add("hide"),o.Y.on("setConfig.splitMode",(({detail:t})=>{"2"!==t?e.classList.add("hide"):e.classList.remove("hide")}),{},"dlc.setConfig.splitMode.randomDanmakuField")})),(0,l.bE)({label:"说书长度下限:",name:"minDanmakuLength",type:"input",props:{type:"number",min:1,style:{width:"48px",margin:"1px"}},helpDesc:"说书长度下限: 仅说书模式生效，断句时会尽量控制弹幕长度在此之上"},(e=>{1!=+t.vc.splitMode&&e.classList.add("hide"),o.Y.on("setConfig.splitMode",(({detail:t})=>{"1"!==t?e.classList.add("hide"):e.classList.remove("hide")}),{},"dlc.setConfig.splitMode.minDanmakuLengthField")})),(0,l.bE)({label:"说书断句符:",name:"splitChar",type:"input",props:{type:"text",min:1,style:{width:"48px",margin:"1px"}},helpDesc:"说书断句符: 说书模式下以配置的符号分割文章为多条弹幕后，再合并到说书长度下限以上的弹幕长度，为空时固定按说书长度下限断句"},(e=>{1!=+t.vc.splitMode&&e.classList.add("hide"),o.Y.on("setConfig.splitMode",(({detail:t})=>{"1"!==t?e.classList.add("hide"):e.classList.remove("hide")}),{},"dlc.setConfig.splitMode.splitCharField")}))]),(0,l.y7)("省流模式: 隐藏无用内容，降低资源占用",[(0,l.bE)({label:"省流模式",name:"lowConsume",type:"input",props:{type:"checkbox"},valueProp:"checked",helpDesc:"只看聊天框，节省流量"},(()=>{const{lowConsume:e}=t.vc;e&&o.Y.on("dlc.ready",c),o.Y.on("setConfig.lowConsume",(({detail:e})=>{c(e),localStorage.setItem(t.vc.configName,JSON.stringify(t.vc))}))})),(0,l.bE)({label:"关闭聊天框滚动",name:"lowConsumeChat",type:"input",props:{type:"checkbox"},valueProp:"checked",helpDesc:"关闭聊天框滚动显示，降低多开时系统显示占用"},(()=>{const{lowConsumeChat:e}=t.vc;e&&o.Y.on("dlc.ready",a),o.Y.on("setConfig.lowConsumeChat",(({detail:e})=>{a(e),localStorage.setItem(t.vc.configName,JSON.stringify(t.vc))}))})),(0,l.bE)({label:"隐藏其他不必要元素",name:"lowConsumeOthers",type:"input",props:{type:"checkbox"},valueProp:"checked",helpDesc:"关闭聊天框滚动显示，降低多开时系统显示占用"},(()=>{const{lowConsumeChat:e}=t.vc;e&&o.Y.on("dlc.ready",i),o.Y.on("setConfig.lowConsumeOthers",(({detail:e})=>{i(e),localStorage.setItem(t.vc.configName,JSON.stringify(t.vc))}))}))]),(0,l.y7)("弹药精炼: 调整弹药内容，降低被杀几率",[(0,l.bE)({label:"弹药扰动",name:"ammoRefine_Disturb",type:"input",props:{type:"checkbox"},valueProp:"checked",helpDesc:"随机去除弹药中的一个字符，提高上top chat概率"}),(0,l.bE)({label:"添加前缀",name:"ammoRefine_prefix",type:"input",props:{type:"checkbox"},valueProp:"checked",helpDesc:"为打出的弹药添加用于穿透蝗粉白名单的前缀"}),(0,l.bE)({label:"添加后缀",name:"ammoRefine_suffix",type:"input",props:{type:"checkbox"},valueProp:"checked",helpDesc:"为打出的弹药添加用于穿透蝗粉白名单的后缀"}),(0,l.bE)({label:"删除大写,标点符号",name:"ammoRefine_ToLower",type:"input",props:{type:"checkbox"},valueProp:"checked",helpDesc:"所有大写字母转换为小写，删除一切标点符号 - 对Nightbot策略"}),(0,l.bE)({label:"弹药精制 (本地)",name:"ammoRefine_Local",type:"input",props:{type:"checkbox"},valueProp:"checked",helpDesc:"将弹药内容精制（如去除屏蔽词，改中文标点符号等， 正则替换等，以提高弹药通过Night bot的几率"}),(0,l.bE)({label:"每个字符后面随机插入日文助词",name:"ammoRefine_SplitWord",type:"input",props:{type:"checkbox"},valueProp:"checked",helpDesc:"每个字符后面随机插入日文助词用来避免被nightbot杀"}),(0,l.bE)({label:"弹药精制策略:",name:"ammoRefineStategy",type:"input",props:{type:"text",style:{width:"150px",margin:"1px"}}}),(0,l.bE)({label:"屏蔽词处理方式:",name:"ammoRefine_BanedWordMode",type:"select",children:[{value:"0",text:"删除屏蔽词"},{value:"1",text:"扰动屏蔽词"},{value:"2",text:"伪装屏蔽词 (测试)"}].map((({text:e,value:t})=>["option",{value:t},e])),helpDesc:"删除屏蔽词: 把屏蔽词直接删除; 扰动屏蔽词: 随机改动屏蔽词中的一个字母; 伪装屏蔽词: 启动屏蔽词伪装, 在特殊战役时期允许解放使用"},(e=>{!0!==t.vc.ammoRefine_Local&&e.classList.add("hide"),o.Y.on("setConfig.ammoRefine_Local",(({detail:t})=>{!0!==t?e.classList.add("hide"):e.classList.remove("hide")}),{},"dlc.setConfig.ammoRefine_Local.banedWordField")}))]),(0,l.y7)("智能发车: 定时或通过监控api来发车",[(0,l.bE)({label:(0,l.h)(["全自动发车:",["input",{type:"checkbox",$click:({target:e})=>{const{infoUrl:n}=t.vc;if(!e.checked)return clearInterval(y),void(0,t.$)("fullAutomation",!1);(0,t.$)("fullAutomation",!0),"https://www.youtube.com/"===window.location.href?((0,l.FN)("监控中..."),(0,x.$0)(n,e),y=setInterval((()=>(0,x.$0)(n,e,!0)),6e4)):(0,l.FN)("只能在油管首页开启监控, 回到首页刷新即可")}}]]),name:"infoUrl",type:"textarea",props:{class:"dlc-textarea",placeholder:"开播监控地址",style:{width:"245px",height:"50px",whiteSpace:"pre"}},helpDesc:"填监控API地址，如果不知道是什么，去NGA翻独轮车发布贴"},(e=>{const{fullAutomation:n,infoUrl:o,lastLiveUrl:c}=t.vc,a=e.querySelector("input");window.location.href===c&&setInterval((()=>(0,x.$0)(o,a,!0,!0)),6e4),n&&(a.checked=!0),n&&""!==o&&"https://www.youtube.com/"===window.location.href&&(a.checked=!0,(0,l.FN)("监控中..."),(0,x.$0)(o,a),y=setInterval((()=>(0,x.$0)(o,a,!0)),6e4))})),(0,l.bE)({label:"开播等待时间(s)",name:"startWaitingTime",type:"input",props:{type:"number",min:5,placeholder:t.vc.startWaitingTime,style:{width:"48px",margin:"1px"}}},(()=>{const{fullAutomation:e}=t.vc;e&&o.Y.on("live.start",(()=>{const{startWaitingTime:e}=t.vc;(0,l.FN)(`独轮车将于${e}秒后启动，如果这不是你的本意，请关闭全自动发车`,"dlc-alert"),setTimeout((()=>{o.Y.emit("dlc.run")}),1e3*e)}))})),(0,l.bE)({label:(0,l.h)([["button",{class:"dlc-btn",$click:({target:n})=>{if("定时启动"!==n.innerText)return;const{startTime:l}=t.vc,c=Date.parse(new Date(l));let a=c-(new Date).getTime();n.innerText=(0,e.mr)(parseInt(a/1e3));const i=()=>{setTimeout((()=>{a>0?(a=c-(new Date).getTime(),n.innerText=(0,e.mr)(parseInt(a/1e3)),i()):(o.Y.emit("dlc.run"),n.innerText="定时启动")}),1e3)};i()}},"定时启动"]]),name:"startTime",type:"input",props:{type:"text",min:1,style:{width:"150px",margin:"1px"}}}),(0,l.bE)({label:(0,l.h)([["button",{class:"dlc-btn",$click:({target:n})=>{if("定时结束"!==n.innerText)return;const{stopTime:l}=t.vc,c=Date.parse(new Date(l));let a=c-(new Date).getTime();n.innerText=(0,e.mr)(parseInt(a/1e3));const i=()=>{setTimeout((()=>{a>0?(a=c-(new Date).getTime(),n.innerText=(0,e.mr)(parseInt(a/1e3)),i()):(o.Y.emit("dlc.stop"),n.innerText="定时结束")}),1e3)};i()}},"定时结束"]]),name:"stopTime",type:"input",props:{type:"text",min:1,style:{width:"150px",margin:"1px"}}})]),(0,l.y7)("远程弹幕库",[(0,l.bE)({label:(0,l.h)(["加载远程弹幕库:",["button",{class:"dlc-btn",$click:({target:e})=>{if("更新"!==e.innerText)return;e.innerText="更新中...";const{remoteDanmakuBase:c}=t.vc,a=c.split("\n").map((e=>e.trim())).filter(Boolean),i=new Set,r=new Set,s=[],d=t=>{r.has(t)||(i.add(t),r.add(t),fetch(t).then((e=>e.json())).then((e=>{e?(Array.isArray(e.extends)&&e.extends.forEach((e=>d(e))),Array.isArray(e.list)&&s.push(e)):s.push({error:`[获取失败]${t}`})})).catch((e=>{console.error(e),s.push({error:`[获取失败]${t}`})})).finally((()=>{i.delete(t),0===i.size&&(o.Y.emit("setRef.remoteDanmakuConfig",s),e.innerText="更新",(0,l.FN)((0,l.h)("pre",{style:{color:"blue"}},n.x.remoteDanmakuConfig.map((e=>e.error||`${e.name||"匿名弹幕库"}: ${e.list.length}条`)).join("\n"))))})))};a.forEach((e=>d(e)))}},"更新"],["span",{},"(未加载弹幕库)",e=>{o.Y.on("setRef.remoteDanmakuConfig",(({detail:t})=>{const n=t.reduce(((e,t)=>e+(t&&t.list.length||0)),0);e.innerText=`(已加载${n}条)`}))}]]),name:"remoteDanmakuBase",type:"textarea",props:{class:"dlc-textarea",placeholder:"支持多个网址，每个一行",style:{width:"265px",height:"70px",overflow:"scroll",whiteSpace:"pre"}},helpDesc:"从指定地址加载弹幕列表，支持添加多个地址，每个一行；远程弹幕列表会添加到本地弹幕列表后；更新的弹幕会在下次出动时生效"})]),t.vc.o?(0,l.y7)("舰载机配置: cv-6相关配置",[(0,l.bE)({label:"cv-6指挥端口:",name:"controlPort",type:"input",props:{type:"number",min:0,placeholder:3,style:{width:"48px",margin:"1px"}},helpDesc:"cv-6服务器端口，一般保持默认即可"})]):["div",{},[]],(0,l.y7)("加特林模式: 切频道点踩开火相关配置",[(0,l.bE)({label:"自动开火",name:"autoAttack",type:"input",props:{type:"checkbox"},valueProp:"checked",helpDesc:"如果不勾选就只切频道+挂踩"}),(0,l.bE)({label:"无限循环",name:"cycleCheck",type:"input",props:{type:"checkbox"},valueProp:"checked",helpDesc:"如果不勾选则循环一轮后便停火，不再切频道开火/点踩"}),(0,l.bE)({label:"自动关闭网页",name:"gatlingAutoStop",type:"input",props:{type:"checkbox"},valueProp:"checked",helpDesc:"未勾选无限循环的情况下，所有号踩完一圈之后自动关闭标签页"}),(0,l.bE)({label:"目标直播间",name:"url",type:"input",props:{type:"text",style:{width:"150px",margin:"1px"}},helpDesc:"开火的直播间地址"}),(0,l.bE)({label:"自动设置直播间地址",name:"autoSetupURL",type:"input",props:{type:"checkbox"},valueProp:"checked",helpDesc:"是否在加特林开火时候自动用当前直播间地址开火"}),(0,l.bE)({label:"点踩最小间隔时间(s):",name:"minDownVoteMin",type:"input",props:{type:"number",min:1,style:{width:"48px",margin:"1px"}},helpDesc:"挂满这么长时间后再点踩"}),(0,l.bE)({label:"点踩最大间隔时间(s):",name:"maxDownVoteMin",type:"input",props:{type:"number",min:1,style:{width:"48px",margin:"1px"}}}),(0,l.bE)({label:"换号最小间隔时间(s):",name:"minChangeChannel",type:"input",props:{type:"number",min:1,style:{width:"48px",margin:"1px"}},helpDesc:"（点过踩以后）继续挂满这么长时间后再换号"}),(0,l.bE)({label:"换号最大间隔时间(s):",name:"maxChangeChannel",type:"input",props:{type:"number",min:1,style:{width:"48px",margin:"1px"}}})]),(0,l.h)([["button",{class:"dlc-btn",$click:()=>{localStorage.setItem(t.vc.configName,JSON.stringify(t.vc)),(0,l.FN)("保存成功")}},"保存配置"]]),(0,l.h)([["button",{class:"dlc-btn",$click:()=>{(0,r.W)()}},"MOD管理"]]),(0,l.h)([["button",{class:"dlc-btn",$click:()=>{let n=t.vc.accountNames;"accountNames"in v.w&&(n=v.w.accountNames),o.Y.emit("dlc.createChannel",n[(0,e.Iy)(0,n.length-1)])}},"新号开频道"]])],e=>{n.x.configFieldContainer=e}]]]]),k=(e,n,o)=>{let l=["input",{type:"checkbox",$click:({target:o})=>{e[n]=o.checked,localStorage.setItem(t.vc.configName,JSON.stringify(t.vc))}}];return e[n]&&(l[1].checked="checked"),["div",{id:`${o}-${n}`},[l,["span",{class:"delete-icon",$click:l=>{delete e[n],document.getElementById(`${o}-${n}`).style.display="none",localStorage.setItem(t.vc.configName,JSON.stringify(t.vc))}}],["label",{},n]]]},_=(e,n)=>{let o=[],c=(0,l.h)([["button",{$click:()=>{let o=document.getElementById(`${n}-input`).value;if(o&&"#"==o[0]&&(o=o.substr(1)),o in e)(0,l.FN)("Tag已经加入了！");else{e[o]=!0;let c=(0,l.h)([k(e,o,n)]);document.getElementById(n).appendChild(c),localStorage.setItem(t.vc.configName,JSON.stringify(t.vc))}}},"添加"],["input",{id:`${n}-input`},""]]);for(let t in e)o.push(k(e,t,n));return["div",{},[["div",{id:n},o],c]]},C=(e="singletonDom")=>{C[e]&&C[e].remove();let n=t.vc.twitter.tags.primary,o=t.vc.twitter.tags.secondary,c=_(n,"tags-primary"),a=_(o,"tags-secondary");const i=(0,l.h)("div",{class:"dlc-mod-mgr"},[["button",{class:"dlc-btn",$click:()=>{i.remove()}},"关闭"],["div",{},"必带的tags"],c,(0,l.$g)(),["div",{},"可选的tags (每次随机选几个复制)"],a]);C[e]=i,document.body.appendChild(i)},T=(e,o="",c=!1)=>{let a=["button",{$click:()=>{let a=document.getElementById("bible-edit-input-name").value,i=document.getElementById("bible-edit-input-content").value;o&&o!==a&&delete e[o],e[a]={content:i,format:c},document.body.removeChild(n.x.duluncheWnd),delete n.x.duluncheWnd,n.x.duluncheWnd=N(GM_info.script.version),n.x.duluncheWnd.style.setProperty("display","block"),document.body.appendChild(n.x.duluncheWnd),localStorage.setItem(t.vc.configName,JSON.stringify(t.vc)),D(),(0,l.FN)("已保存")}},"保存"],i=["input",{type:"checkbox",$click:({target:e})=>{c=e.checked}}];c&&(i[1].checked="checked");let r=["input",{id:"bible-edit-input-name",value:o}];return(0,l.h)([["div",{},[a,["div",{},[i,["label",{},"格式化定型文（暂时没意义）"]]],["div",{},[["div",{},"定型文名字: "],r]],["div",{},[["div",{},"定型文内容: "],["textarea",{id:"bible-edit-input-content"}]]]]]])},E=(e,o,c)=>{let a=(0,l.h)([["button",{$click:()=>{(0,l.FN)(T(e,o,e[o].format)),document.getElementById("bible-edit-input-content").value=e[o].content}},"编辑"]]);return["div",{id:`${c}-${o}`},[a,["span",{class:"delete-icon",$click:l=>{delete e[o],document.getElementById(`${c}-${o}`).style.display="none",localStorage.setItem(t.vc.configName,JSON.stringify(t.vc)),document.body.removeChild(n.x.duluncheWnd),delete n.x.duluncheWnd,n.x.duluncheWnd=N(GM_info.script.version),n.x.duluncheWnd.style.setProperty("display","block"),document.body.appendChild(n.x.duluncheWnd),localStorage.setItem(t.vc.configName,JSON.stringify(t.vc))}}],["label",{},o]]]},D=(e="singletonDom")=>{D[e]&&D[e].remove();let n=((e,t)=>{let n=[];for(let o in e)n.push(E(e,o,t));return["div",{},[["div",{id:t},n],["button",{$click:()=>{(0,l.FN)(T(e))}},"添加"]]]})(t.vc.twitter.bibles,"bibles");const o=(0,l.h)("div",{class:"dlc-mod-mgr"},[["button",{class:"dlc-btn",$click:()=>{o.remove()}},"关闭"],["div",{},"定型文列表"],n]);D[e]=o,document.body.appendChild(o)},N=o=>{let c=[];for(let e in t.vc.twitter.bibles){let n=t.vc.twitter.bibles[e];c.push((0,l.JJ)(e,n.content,n.format))}return(0,l.h)("div",{class:"dlc-cmd"},[["div",{class:"dlc-titlebar",$mousedown(e){if(e.target!==this)return;const t=(0,l.h)("div",{style:{position:"fixed",left:"0",top:"0",width:"100vw",height:"100vh"}});this.style.cursor="all-scroll",document.body.appendChild(t);const{layerX:o,layerY:c}=e,a=e=>{n.x.duluncheWnd.style.left=e.clientX-o+"px",n.x.duluncheWnd.style.top=e.clientY-c+"px"};document.addEventListener("mousemove",a),document.addEventListener("mouseup",(()=>{document.removeEventListener("mousemove",a),this.style.cursor="",t.remove()}),{once:!0})}},[`v${o}`,["div",{class:"dlc-close-btn",style:"position: absolute; right: 0;",$click:e=>{e.stopPropagation(),n.x.duluncheWnd.style.setProperty("display","none")}},"X"]]],["div",{style:{margin:"0 auto"}},[(0,l.h)([["button",{class:"dlc-btn",$click:()=>{let n=[];for(let e in t.vc.twitter.tags.primary)t.vc.twitter.tags.primary[e]&&n.push(e);let o=[];for(let e in t.vc.twitter.tags.secondary)t.vc.twitter.tags.secondary[e]&&o.push(e);if(t.vc.nTags<o.length)for(let l=0;l<t.vc.nTags;l++){let t=(0,e.Iy)(l,o.length-1);n.push(o[t]),o[t]=o[l]}else n=n.concat(o);(0,e.qb)(n.map((e=>`#${e}`)).join(" "),"",!1)}},"复制Tags"]]),(0,l.h)([["button",{class:"dlc-btn",$click:()=>{C()}},"Tags管理"]]),(0,l.h)([["button",{class:"dlc-btn",$click:()=>{D()}},"定型文管理"]]),(0,l.bE)({label:"复制的次要Tags数量:",name:"nTags",type:"input",props:{type:"number",min:0,placeholder:1,style:{width:"48px",margin:"1px"}},helpDesc:"复制的次要tags数量。点击复制tags时，所有主要tags和指定数量的随机次要tags都会被复制。"}),(0,l.h)([["button",{class:"dlc-btn",$click:()=>{localStorage.setItem(t.vc.configName,JSON.stringify(t.vc)),(0,l.FN)("保存成功")}},"保存配置"]]),["div",{},"圣 经 咏 唱"]].concat(c),e=>{n.x.configFieldContainer=e}]])};var B=__webpack_require__(484);let $=!1;var S=__webpack_require__(601);const I={map:[],default:()=>{},finish:()=>{},add:(e,t)=>{let n={checker:e,method:t};I.map.push(n)},run:e=>{let t=!1;for(let n=0;n<I.map.length;n++){let o=I.map[n];if(o.checker(e)){o.method(),t=!0;break}}t||I.default(),I.finish()}};(()=>{if(window.top!==window.self)return;if(unsafeWindow.dulunche)return void alert(`您似乎同时启动了多个不同版本的油管独轮车。请关闭其他独轮车。\n    -- 来自${GM_info.script.name} v${GM_info.script.version}`);const i=GM_info.script.version;if((0,t.ME)(t.vc.configName),document.body.appendChild((0,l.h)("style",{},`\n.dlc-cmd {\n  color: ${t.Dc.fontColor};\n  background: ${t.Dc.backgroundCmd};\n  width: 265px;\n  z-index: 998;\n  position: fixed;\n  padding: 5px;\n\n  font-size:120%;\n  box-sizing: content-box;\n  border: 1px solid ${t.Dc.border};\n  border-radius: 5px;\n  right: 10px;\n  top: 30%;\n  display: none;\n}\n.dlc-cmd-list {\n  width: 270px;\n  height: 545px;\n  overflow-y: auto;\n  overflow-x: hidden;\n  scrollbar-width: thin;\n  left: 5px; \n}\n.dlc-cmd-list::-webkit-scrollbar{\n  width:7px;\n  height:7px;\n  /**/\n}\n.dlc-cmd-list::-webkit-scrollbar-track{\n  background: rgb(239, 239, 239);\n  border-radius:2px;\n}\n.dlc-cmd-list::-webkit-scrollbar-thumb{\n  background: #bfbfbf;\n  border-radius:10px;\n}\n.dlc-cmd-list::-webkit-scrollbar-thumb:hover{\n  background: #333;\n}\n.dlc-titlebar {\n  user-select: none;\n  background-color: ${t.Dc.titlebar};\n  display: inline-flex;\n  align-items: center;\n  width: 100%;\n}\n.dlc-close-btn {\n  display: inline-block;\n  position: relative;\n  text-align: center;\n  width: 19px;\n  height: 19px;\n  color: ${t.Dc.closeBtnColor};\n  cursor: pointer;\n  float: right;\n  margin-left: 5px;\n  margin-right: 5px;\n  background-color: black;\n  border: ${t.Dc.btnBorder} 1px solid;\n  line-height: 21px;\n}\n.dlc-btn {\n  display: inline-block;\n  background: ${t.Dc.btn};\n  color: ${t.Dc.btnColor};\n  min-width: 70px;\n  height: 24px;\n  margin: 2px;\n}\n.dlc-textarea {\n  background: ${t.Dc.textareaBackground};\n  color: ${t.Dc.textareaColor};\n  scrollbar-width: thin;\n  width: 260px;\n  border-radius: 5px;\n}\n.dlc-textarea::-webkit-scrollbar{\n  width:7px;\n  height:7px;\n  border-radius: 5px;\n  /**/\n}\n.dlc-textarea::-webkit-scrollbar-track{\n  background: rgb(239, 239, 239);\n  border-radius:2px;\n}\n.dlc-textarea::-webkit-scrollbar-thumb{\n  background: #bfbfbf;\n  border-radius:5px;\n}\n.dlc-textarea::-webkit-scrollbar-thumb:hover{\n  background: #333;\n}\n.dlc-suspension {\n  background: ${t.Dc.suspension};\n  color:${t.Dc.btnColor};\n  overflow: hidden;\n  z-index: 850;\n  position: fixed;\n  padding:5px;\n  text-align:center;\n  width: 85px;\n  height: 22px;\n  border-radius: 5px;\n  right: 10px;\n  top: 30%;\n}\n.dlc-toast {\n  top: 10px;\n  left: 10px;\n  max-height: 90vh;\n  max-width: 60vw;\n  overflow: auto;\n  position: fixed;\n  background: ${t.Dc.backgroundToast};\n  padding: 16px;\n  border: 1px solid ${t.Dc.border};\n  border-radius: 5px;\n}\n.dlc-alert {\n  max-height: 90vh;\n  max-width: 60vw;\n  overflow: auto;\n  background: ${t.Dc.backgroundToast};\n  padding: 16px;\n  border: ${t.Dc.btnBorder} 1px solid;\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%,-50%);\n}\n.dlc-mod-mgr {\n  max-height: 140vh;\n  max-width: 150vw;\n  overflow: auto;\n  background: ${t.Dc.backgroundToast};\n  padding: 16px;\n  border: ${t.Dc.btnBorder} 1px solid;\n  position: fixed;\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%,-50%);\n}\n.help-icon::after {\n  content: '?';\n  margin-left: 4px;\n  margin-right: 4px;\n  display: inline-block;\n  color: ${t.Dc.helpIconColor};\n  background-color: ${t.Dc.helpIconBackground};\n  border-radius: 50%;\n  width: 16px;\n  height: 16px;\n  line-height: 16px;\n  text-align: center;\n  border: #999 1px solid;\n  font-size: 12px;\n}\n.delete-icon::after {\n  content: '🗑️';\n  margin-left: 4px;\n  margin-right: 4px;\n  display: inline-block;\n  color: ${t.Dc.helpIconColor};\n  background-color: ${t.Dc.helpIconBackground};\n  border-radius: 50%;\n  width: 16px;\n  height: 16px;\n  line-height: 16px;\n  text-align: center;\n  border: #999 1px solid;\n  font-size: 12px;\n}\n.import-export-icon {\n  margin-right: 4px;\n  display: inline-block;\n  color: ${t.Dc.helpIconColor};\n  background-color: ${t.Dc.helpIconBackground};\n  border-radius: 50%;\n  width: 16px;\n  height: 16px;\n  line-height: 16px;\n  text-align: center;\n  border: #999 1px solid;\n  font-size: 12px;\n}\n.hide {\n  display: none;\n}\n.label{\n  display:block;\n  vertical-align: middle;\n}\n.label, input, select{\n  vertical-align: middle;\n}\n.mui-switch {\n  width: 37px;\n  height: 20px;\n  position: relative;\n  border: 1px solid #dfdfdf;\n  background-color: #fdfdfd;\n  box-shadow: #dfdfdf 0 0 0 0 inset;\n  border-radius: 10px;\n  border-top-left-radius: 10px;\n  border-top-right-radius: 10px;\n  border-bottom-left-radius: 10px;\n  border-bottom-right-radius: 10px;\n  background-clip: content-box;\n  display: inline-block;\n  -webkit-appearance: none;\n  user-select: none;\n  outline: none;\n}\n.mui-switch:before {\n  content: '✈️';\n  width: 18px;\n  height: 18px;\n  text-align: center;\n  line-height: 18px;\n  position: absolute;\n  top: 0px;\n  left: 0;\n  border-radius: 9px;\n  border-top-left-radius: 9px;\n  border-top-right-radius: 9px;\n  border-bottom-left-radius: 9px;\n  border-bottom-right-radius: 9px;\n  background-color: #fff;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);\n}\n.mui-switch:checked {\n  border-color: #64bd63;\n  box-shadow: #64bd63 0 0 0 16px inset;\n  background-color: #64bd63; }\n.mui-switch:checked:before {\n    left: 16px;\n}\n.mui-switch.mui-switch-animbg {\n  transition: background-color ease 0.4s;\n}\n.mui-switch.mui-switch-animbg:before {\n  transition: left 0.3s;\n}\n.mui-switch.mui-switch-animbg:checked {\n  box-shadow: #dfdfdf 0 0 0 0 inset;\n  background-color: #64bd63;\n  transition: border-color 0.4s, background-color ease 0.4s;\n}\n.mui-switch.mui-switch-animbg:checked:before {\n  transition: left 0.3s;\n}\n.mui-switch.mui-switch-anim {\n  transition: border cubic-bezier(0, 0, 0, 1) 0.4s, box-shadow cubic-bezier(0, 0, 0, 1) 0.4s;\n}\n.mui-switch.mui-switch-anim:before {\n  transition: left 0.3s;\n}\n.mui-switch.mui-switch-anim:checked {\n  box-shadow: #64bd63 0 0 0 16px inset;\n  background-color: #64bd63;\n  transition: border ease 0.4s, box-shadow ease 0.4s, background-color ease 1.2s;\n}\n.mui-switch.mui-switch-anim:checked:before {\n  transition: left 0.3s;\n}\n`)),(0,e.Ye)(i),document.location.href.match(/.*:\/\/twitter\.com.*/)){let e=(0,l.h)("div",{class:"dlc-suspension",$click:()=>{(0,l.FN)("蓝桐独轮车开发中(功能说明还没写) 欢迎各位提出意见和建议。"),n.x.duluncheWnd.style.setProperty("display","block")}},"蓝桐独轮车");n.x.duluncheWnd=N(i),document.body.appendChild(e),document.body.appendChild(n.x.duluncheWnd)}else{((e=!0)=>{const t=document.querySelectorAll("video");0==t.length?(0,l.FN)("找不到播放器! 注意耳朵"):t[0].addEventListener("canplaythrough",(()=>{c(e,init=!0)}))})(t.vc.lowConsume),a(t.vc.lowConsumeChat),(0,o.T)(),I.add((e=>"https://www.youtube.com/channel_switcher?next=%2Faccount&feature=settings"===e||"https://www.youtube.com/channel_switcher?next=%2Faccount&feature=settings#"===e),S.pj),I.add((e=>e.match(/.*:\/\/accounts\.google\.com\/b\/.*/)),S.rC),I.run(window.location.href),n.x.duluncheWnd=w(i);let e=(e=>(0,l.h)("div",{class:"dlc-suspension",$click:()=>{n.x.duluncheWnd.style.setProperty("display","block"),$||($=!0,(0,l.FN)((0,B.n)(oldVersion=e,newVersion=v.w.version,logs=v.w.logs.split(";"),announcement=v.w.announcement)))}},"初始化中...",(e=>{o.Y.on("dlc.ready",(()=>{e.textContent="舰载机控制台"}),{once:!0},"dlc.ready.default")})))(i);unsafeWindow.dulunche={version:i,config:new Proxy(t.vc,{set(e,t,n){o.Y.emit(`setConfig.${t}`,n)}}),eventBus:o.Y,refs:n.x,components:{Toast:l.FN,ConfigField:l.bE,h:l.h}},(0,r.l)(),(0,n.d)(),(0,x.Bg)(),((e,t)=>{document.onfullscreenchange=()=>{if(document.fullscreenElement){e.style.setProperty("display","none"),t.style.setProperty("display","none");let n=document.getElementById("account_email");n&&n.style.setProperty("display","none")}else{e.style.setProperty("display","block");let t=document.getElementById("account_email");t&&t.style.setProperty("display","block")}}})(e,n.x.duluncheWnd),document.body.appendChild(e),document.body.appendChild(n.x.duluncheWnd)}})()})()})();